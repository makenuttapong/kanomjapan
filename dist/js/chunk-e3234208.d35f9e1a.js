(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e3234208"],{"30b0":function(t,a,e){"use strict";e("5a74")},"5a74":function(t,a,e){},6407:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"overflow-auto"},[e("div",{staticClass:"pagination-item"},[e("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},on:{input:function(a){return t.updatePage(t.currentPage)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)])},r=[],i={name:"Pagination",props:["currentPage","totalItem","itemPerPage","start","end"],data(){return{perPage:this.itemPerPage}},methods:{updatePage(t){this.$emit("selectedPage",t-1)}},computed:{rows(){return this.totalItem}}},o=i,l=(e("30b0"),e("2877")),c=Object(l["a"])(o,s,r,!1,null,"62654af7",null);a["a"]=c.exports},8401:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("b-card",[e("h5",{staticClass:"mb-4"},[e("i",{staticClass:"fa fa-history",attrs:{color:"#7367f0"}}),t._v(" ประวัติการสั่งซื้อ ")]),e("b-tabs",{attrs:{pills:""}},[e("b-tab",{attrs:{active:""},on:{click:function(a){return t.changeStatus("all")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-clipboard-check"}),e("span",{staticClass:"d-none d-sm-inline"},[t._v(" คำสั่งซื้อทั้งหมด")])]},proxy:!0}])}),e("b-tab",{on:{click:function(a){return t.changeStatus("to-pay")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-credit-card"}),e("span",{staticClass:"d-none d-sm-inline"},[t._v(" ที่ต้องชำระ")])]},proxy:!0}])}),e("b-tab",{on:{click:function(a){return t.changeStatus("to-receive")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-truck"}),e("span",{staticClass:"d-none d-sm-inline"},[t._v(" ที่ต้องได้รับ")])]},proxy:!0}])}),e("b-tab",{on:{click:function(a){return t.changeStatus("to-success")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-check"}),e("span",{staticClass:"d-none d-sm-inline"},[t._v(" ที่จัดส่งแล้ว")])]},proxy:!0}])}),e("b-tab",{on:{click:function(a){return t.changeStatus("to-cancle")}},scopedSlots:t._u([{key:"title",fn:function(){return[e("i",{staticClass:"fa fa-times"}),e("span",{staticClass:"d-none d-sm-inline"},[t._v(" ที่ถูกยกเลิก")])]},proxy:!0}])})],1),t.loading?e("div",{staticClass:"p-4"},[e("vcl-list")],1):t._e(),t.loading?t._e():e("div",{staticClass:"mt-4 pt-2"},[e("ListofOrder",{attrs:{orderItem:t.orderItem,start:t.itemStart,end:t.itemEnd,totalItem:t.totalDatas},on:{toDetailPage:t.detailPage,toPayPage:t.paypage,confirmGetItem:t.confirmGet}}),0!=t.orderItem.length?e("div",{staticClass:"mt-3"},[e("Pagination",{attrs:{currentPage:this.$store.state.currentP+1,totalItem:t.totalDatas,itemPerPage:t.itemPerPage,start:t.itemStart,end:t.itemEnd},on:{selectedPage:t.loadMore}})],1):t._e()],1)],1)],1)},r=[],i=e("28f7"),o=(e("78a7"),e("68ee")),l=e("6407"),c=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[0==t.orderItem.length?e("div",{staticClass:"text-center p-4 h6"},[t._v(" ไม่พบข้อมูล ")]):t._e(),0!=t.orderItem.length?e("div",{staticClass:"text-mute"},[t._v(" รายการที่ "+t._s(t.start)+" - "+t._s(t.end)+" จาก "+t._s(t.totalItem)+" รายการ ")]):t._e(),t._l(t.orderItem,(function(a,s){return e("div",{key:s},[e("b-card",{staticClass:"mt-2 card-border collapse-icon"},[e("div",{staticClass:"content-order row"},[e("div",{staticClass:"col-12 col-sm-6 col-md-3 col-lg-2"},[e("small",{staticClass:"text-primary"},[t._v("หมายเลขคำสั่งซื้อ")]),e("div",[e("FileTextIcon",{staticClass:"mb-1 mr-1",attrs:{size:"18",color:"#7367f0"}}),t._v(t._s(a.orderID)+" ")],1)]),e("div",{staticClass:"col-12 col-sm-6 col-md-3 col-lg-2"},[e("small",{staticClass:"text-primary"},[t._v("วันที่สั่ง")]),e("div",{staticClass:"createOrder"},[e("CalendarIcon",{staticClass:"mb-1 mr-1",attrs:{size:"14"}}),t._v(t._s(a.createAt)+" ")],1)]),e("div",{staticClass:"col-12 col-sm-6 col-md-3 col-lg-2"},[e("small",{staticClass:"text-primary"},[t._v("สถานะ")]),"รอชำระ"==a.status?e("div",[e("b-badge",{staticClass:"status-wait-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-clock"}),t._v(" "+t._s(a.status))])],1):t._e(),"รอการตรวจสอบ"==a.status?e("div",[e("b-badge",{staticClass:"status-checkSlip-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-search-dollar"}),t._v(" "+t._s(a.status))])],1):t._e(),"เตรียมจัดส่ง"==a.status?e("div",[e("b-badge",{staticClass:"status-ready-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-truck-loading"}),t._v(" "+t._s(a.status))])],1):t._e(),"อยู่ระหว่างการจัดส่ง"==a.status?e("div",[e("b-badge",{staticClass:"status-sent-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-shipping-fast"}),t._v(" "+t._s(a.status))])],1):t._e(),"จัดส่งแล้ว"==a.status?e("div",[e("b-badge",{staticClass:"status-check-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-check"}),t._v(" "+t._s(a.status))])],1):t._e(),"ยกเลิก"==a.status?e("div",[e("b-badge",{staticClass:"status-cancle-style font-14",attrs:{pill:""}},[e("i",{staticClass:"fa fa-times"}),t._v(" "+t._s(a.status))])],1):t._e()]),e("div",{staticClass:"col-12 col-sm-6 col-md-2 d-none d-lg-inline"},["อยู่ระหว่างการจัดส่ง"==a.status||"จัดส่งแล้ว"==a.status?e("div",{staticClass:"col tackNum"},[e("small",{staticClass:"text-primary"},[t._v("หมายเลขพัสดุ")]),e("div",[t._v(t._s(a.deliverNumber?a.deliverNumber:"-"))])]):t._e(),"อยู่ระหว่างการจัดส่ง"!=a.status&&"จัดส่งแล้ว"!=a.status?e("div",{staticClass:"col slip"},[e("small",{staticClass:"text-primary"},[t._v("รายการสินค้า")]),e("div",[t._v(" "+t._s(0!=a.orderItems.length?a.orderItems.length:"0")+" รายการ ")])]):t._e()]),e("div",{staticClass:"col-12 col-sm-6 col-md-2 d-none d-lg-inline"},["อยู่ระหว่างการจัดส่ง"==a.status||"จัดส่งแล้ว"==a.status?e("div",{staticClass:"col tackCom"},[e("small",{staticClass:"text-primary"},[t._v("บริษัทขนส่ง")]),e("div",[t._v(t._s(a.deliverCompany?a.deliverCompany:"-"))])]):t._e(),"อยู่ระหว่างการจัดส่ง"!=a.status&&"จัดส่งแล้ว"!=a.status?e("div",{staticClass:"col all-price"},[e("small",{staticClass:"text-primary"},[t._v("ราคารวม")]),e("div",[t._v(" "+t._s(a.totalAll?t.formatPrice(a.totalAll):"-")+" บาท ")])]):t._e()]),e("div",{staticClass:"col-12 col-sm-6 col-md-3 col-lg-2 icon-pay"},["รอชำระ"==a.status?e("b-button",{attrs:{variant:"orange",id:"pay-order-"+a.accId},on:{click:function(e){return t.toPay(a.id)}}},[e("CreditCardIcon",{attrs:{size:"20"}})],1):t._e(),"รอชำระ"==a.status?e("b-tooltip",{attrs:{target:"pay-order-"+a.accId,triggers:"hover"}},[t._v(" ชำระสินค้า ")]):t._e(),"จัดส่งแล้ว"==a.status?e("b-button",{attrs:{variant:"yellow",id:"pay-order-"+a.accId},on:{click:function(e){return t.rating(a.id)}}},[e("StarIcon",{attrs:{size:"20"}})],1):t._e(),"จัดส่งแล้ว"==a.status?e("b-tooltip",{attrs:{target:"pay-order-"+a.accId,triggers:"hover"}},[t._v(" ให้คะแนนสินค้า ")]):t._e(),"อยู่ระหว่างการจัดส่ง"==a.status?e("b-button",{attrs:{variant:"green",id:"pay-order-"+a.accId},on:{click:function(e){return t.toggleModal(a)}}},[e("PackageIcon",{attrs:{size:"20"}})],1):t._e(),"อยู่ระหว่างการจัดส่ง"==a.status?e("b-tooltip",{attrs:{target:"pay-order-"+a.accId,triggers:"hover"}},[t._v(" ได้รับสินค้าแล้ว ")]):t._e(),e("b-button",{staticClass:"ml-2",attrs:{variant:"primary",id:"detail-order-"+a.accId},on:{click:function(e){return t.toDetail(a.id)}}},[e("SearchIcon",{attrs:{size:"20"}})],1),e("b-tooltip",{attrs:{target:"detail-order-"+a.accId,triggers:"hover"}},[t._v(" ดูรายละเอียด ")])],1)])])],1)})),e("b-modal",{attrs:{id:"modal-conf","hide-footer":"",size:"md",title:"ยืนยันการรับสินค้า"}},[[e("div",{staticClass:"center"},[t._v("ยืนยันว่าคุณได้ตรวจสอบและรับสินค้าแล้ว")]),e("div",{staticClass:"btn-delete text-center mt-2"},[e("b-row",[e("b-col",{staticClass:"mt-2 mb-2",attrs:{cols:"12"}},[e("b-button",{staticClass:"mr-1",attrs:{variant:"primary"},on:{click:t.comfirmGet}},[t._v("ยืนยัน")]),e("b-button",{attrs:{variant:"outline-primary"},on:{click:t.toggleModalConfirmGet}},[t._v("ยกเลิก")])],1)],1)],1)]],2)],2)},n=[],d=e("0a35"),u={name:"ListofOrder",data(){return{idOrder:{}}},components:{CreditCardIcon:d["e"],SearchIcon:d["n"],StarIcon:d["r"],PackageIcon:d["k"],FileTextIcon:d["g"],CalendarIcon:d["c"]},props:["orderItem","start","end","totalItem"],methods:{toDetail(t){this.$emit("toDetailPage",t)},toPay(t){this.$emit("toPayPage",t)},rating(t){this.$router.push("/rating/"+t)},formatPrice(t){let a=(t/1).toFixed(0);return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},comfirmGet(){this.$bvModal.hide("modal-conf"),this.$emit("confirmGetItem",this.idOrder)},toggleModal(t){this.idOrder=t,this.$bvModal.show("modal-conf")},toggleModalConfirmGet(){this.$bvModal.hide("modal-conf")}}},m=u,h=e("2877"),g=Object(h["a"])(m,c,n,!1,null,null,null),p=g.exports,v=e("c1df"),f=e.n(v),_={name:"OrderList",components:{VclList:o["VclList"],ListofOrder:p,Pagination:l["a"]},computed:{currentP(){return this.$store.state.currentP}},data(){return{loading:!1,statusOrder:"all",orderItem:[],totalDatas:null,itemPerPage:20,itemStart:null,itemEnd:null}},created(){window.scrollTo(0,0),this.loadOrders()},methods:{changeStatus(t){this.$store.dispatch("changePage",0),this.statusOrder=t,this.loadOrders()},loadOrders(){this.loading=!0;let t=this.itemPerPage*this.$store.state.currentP;const a=i["a"].firestore().collection("orders");if("to-pay"==this.statusOrder)var e=a.where("userID","==",i["a"].auth().currentUser.uid).where("status","in",["รอชำระ","รอการตรวจสอบ"]).orderBy("createAt","desc");else e="to-receive"==this.statusOrder?a.where("userID","==",i["a"].auth().currentUser.uid).where("status","in",["อยู่ระหว่างการจัดส่ง","เตรียมจัดส่ง"]).orderBy("createAt","desc"):"to-success"==this.statusOrder?a.where("userID","==",i["a"].auth().currentUser.uid).where("status","==","จัดส่งแล้ว").orderBy("createAt","desc"):"to-cancle"==this.statusOrder?a.where("userID","==",i["a"].auth().currentUser.uid).where("status","==","ยกเลิก").orderBy("createAt","desc"):a.where("userID","==",i["a"].auth().currentUser.uid).orderBy("createAt","desc");return e.get().then(a=>{let s=a.docs[t];var r=a.docs.length,i=this.$store.state.currentP+1,o=i*this.itemPerPage-(this.itemPerPage-1),l=Math.min(o+this.itemPerPage-1,r);if(this.itemStart=o,this.itemEnd=l,this.totalDatas=r,s)var c=e.startAt(s).limit(this.itemPerPage);else c=e.limit(this.itemPerPage);c.get().then(t=>{var a=[],e=1;t.forEach(t=>{var s={id:t.id,accId:e,orderID:t.data().orderID,orderItems:t.data().items,status:t.data().status,totalAll:t.data().totalAll,items:t.data().items.length,deliverPrice:t.data().deliverPrice,paywith:t.data().paywith,slipImage:t.data().slipImage,address:t.data().address,payon:t.data().payon?this.formatDate(t.data().payon):"",deliverNumber:t.data().deliverNumber,deliverCompany:t.data().deliverCompany,createAt:t.data().createAt?this.formatDate(t.data().createAt):"",updateAt:t.data().updateAt?this.formatDate(t.data().updateAt):""};a.push(s),e+=1}),this.orderItem=a,this.loading=!1}).catch(t=>{console.log(t),this.loading=!1})}).catch(t=>{console.log(t),this.loading=!1})},detailPage(t){this.$router.push("/user-order/"+t)},formatDate(t){var a=t.toDate(),e=f()(a).format("DD-MM-YYYY HH:mm");return e},paypage(t){this.$router.push("/confirm-order/"+t)},toggleModalUpload(){console.log("upload")},loadMore(t){this.$store.dispatch("changePage",t),this.loadOrders()},confirmGet(t){var a={status:"จัดส่งแล้ว",updateAt:new Date};const e=i["a"].firestore().doc("orders/"+t.id);e.update(a).then(()=>{const a=i["a"].auth().currentUser;i["a"].firestore().doc("users/"+a.uid).get().then(a=>{const e=i["a"].firestore().collection("incomes");var s={createAt:new Date,description:"ได้รับเงินจากการซื้อสินค้า",orderID:t.orderID,status:"cash-in",price:t.totalAll,userProfile:{image:a.data().image,email:a.data().email,name:a.data().name,role:a.data().role,userID:a.id}};e.add(s),this.loadOrders()}).catch(t=>{console.log(t)})}).catch(t=>{console.log(t)})}}},C=_,b=Object(h["a"])(C,s,r,!1,null,null,null);a["default"]=b.exports}}]);
//# sourceMappingURL=chunk-e3234208.d35f9e1a.js.map