(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d5e20646"],{"30b0":function(t,e,a){"use strict";a("5a74")},"5a74":function(t,e,a){},"63ca":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-card",{staticClass:"overflow-hidden"},[s("h5",{staticClass:"mb-4"},[s("i",{staticClass:"fa fa-cookie-bite",attrs:{color:"#7367f0"}}),t._v(" สินค้า ")]),t.loading?t._e():s("div",{staticClass:"addData"},[s("b-button",{attrs:{variant:"primary"},on:{click:function(e){return t.toggleModal("add","")}}},[s("span",{staticClass:"d-none d-sm-inline"},[t._v("เพิ่มสินค้า ")]),s("i",{staticClass:"fa fa-plus-circle"})])],1),s("div",{staticClass:"mb-3 mx-2"},[s("b-row",[s("b-col",{staticClass:"d-flex align-items-center justify-content-start mb-1",attrs:{cols:"12",lg:"3",md:"6"}},[s("label",[t._v("แสดง")]),s("b-select",{staticClass:"\n              per-page-selector\n              d-inline-block\n              mx-50\n              select-per-page\n              ml-2\n              mr-2\n            ",attrs:{options:t.perPageOptions,clearable:!1},on:{change:t.changeItemPerPage},model:{value:t.itemPerPage,callback:function(e){t.itemPerPage=e},expression:"itemPerPage"}}),s("label",[t._v("รายการ")])],1),s("b-col",{staticClass:"d-md-none",attrs:{cols:"12",lg:"6",md:"6"}},[s("div",{staticClass:"mb-3 text-right custom-filters"},[s("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse-filter",expression:"'collapse-filter'"}],staticClass:"collapse-icon",attrs:{size:"sm",variant:"outline-info"}},[t._v("ฟิลเตอร์ "),s("div",{staticClass:"col-1 icon-coll d-inline"},[s("i",{staticClass:"fa fa-chevron-up icon-coll-open-filter"})])])],1),s("b-collapse",{attrs:{id:"collapse-filter"}},[s("div",{staticClass:"d-flex align-items-center justify-content-end mb-1"},[s("label",{staticClass:"catagory-width"},[t._v("หมวดหมู่")]),s("b-form-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{id:"product-catagory",clearable:!1,options:t.catagorysFilter},on:{change:t.changeCatagory},model:{value:t.catagorySelected,callback:function(e){t.catagorySelected=e},expression:"catagorySelected"}})],1),s("div",{staticClass:"d-flex align-items-center justify-content-start mb-1"},[s("label",{staticClass:"catagory-width"},[t._v("ประเภท")]),s("b-form-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{id:"product-type",clearable:!1,options:t.typeFilter},on:{change:t.changeType},model:{value:t.typeSelected,callback:function(e){t.typeSelected=e},expression:"typeSelected"}})],1),s("div",{staticClass:"d-flex align-items-center justify-content-end"},[s("b-form",{on:{submit:function(e){return e.preventDefault(),t.searchProduct(e)}}},[s("b-input-group",{staticClass:"input-group-merge pr-2"},[s("b-form-input",{staticClass:"d-inline-block",attrs:{placeholder:"ค้นหาสินค้า",autocomplete:"off"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),s("b-input-group-append",{staticClass:"pointer",attrs:{"is-text":""},on:{click:t.searchProduct}},[s("i",{staticClass:"fas fa-search"})])],1)],1)],1)])],1),s("b-col",{staticClass:"d-none d-md-inline",attrs:{cols:"12",lg:"3",md:"6"}},[s("div",{staticClass:"d-flex align-items-center justify-content-end mb-1"},[s("label",{staticClass:"catagory-width"},[t._v("หมวดหมู่")]),s("b-form-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{id:"product-catagory",clearable:!1,options:t.catagorysFilter},on:{change:t.changeCatagory},model:{value:t.catagorySelected,callback:function(e){t.catagorySelected=e},expression:"catagorySelected"}})],1)]),s("b-col",{staticClass:"d-none d-md-inline",attrs:{cols:"12",lg:"3",md:"6"}},[s("div",{staticClass:"d-flex align-items-center justify-content-start mb-1"},[s("label",{staticClass:"catagory-width"},[t._v("ประเภท")]),s("b-form-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{id:"product-type",clearable:!1,options:t.typeFilter},on:{change:t.changeType},model:{value:t.typeSelected,callback:function(e){t.typeSelected=e},expression:"typeSelected"}})],1)]),s("b-col",{staticClass:"d-none d-md-inline",attrs:{cols:"12",lg:"3",md:"6"}},[s("div",{staticClass:"d-flex align-items-center justify-content-end"},[s("b-form",{on:{submit:function(e){return e.preventDefault(),t.searchProduct(e)}}},[s("b-input-group",{staticClass:"input-group-merge pr-2"},[s("b-form-input",{staticClass:"d-inline-block",attrs:{placeholder:"ค้นหาสินค้า",autocomplete:"off"},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),s("b-input-group-append",{staticClass:"pointer",attrs:{"is-text":""},on:{click:t.searchProduct}},[s("i",{staticClass:"fas fa-search"})])],1)],1)],1)])],1)],1),t.loading?s("div",{staticClass:"p-5"},[s("vcl-table")],1):t._e(),t.loading?t._e():s("div",[s("b-card-body",[0!=t.products.length?s("div",{staticClass:"text-mute mb-2"},[t._v(" สินค้าที่ "+t._s(t.itemStart)+" - "+t._s(t.itemEnd)+" จาก "+t._s(t.totalDatas)+" ")]):t._e(),s("b-table",{attrs:{items:t.products,fields:t.fields,hover:!0,responsive:"","show-empty":"","empty-text":"ไม่พบข้อมูล","empty-filtered-text":"ไม่พบข้อมูล","tbody-tr-class":t.rowClass},scopedSlots:t._u([{key:"cell(image)",fn:function(e){return[s("img",{class:0==e.item.stock?"img-gray":"custom-show-img-table",attrs:{src:e.item.image?e.item.image:a("c548"),width:"70px",height:"70px"},on:{click:function(a){return t.getDetail(e.item)}}}),e.item.discount?s("span",{staticClass:"fa-stack fa-lg"},[s("i",{staticClass:"fa fa-certificate fa-stack-2x"}),s("i",{staticClass:"fa fa-tag fa-stack-1x fa-inverse"})]):t._e()]}},{key:"cell(name)",fn:function(e){return[s("div",{staticClass:"pro-name",on:{click:function(a){return t.getDetail(e.item)}}},[t._v(" "+t._s(e.item.name)+" ")]),s("div",{staticClass:"pro-id"},[t._v(t._s(e.item.productID))]),s("div",{staticClass:"pro-star"},[s("ul",{staticClass:"unstyled-list list-inline"},t._l(5,(function(a){return s("li",{key:a,staticClass:"ratings-list-item mr-25"},[s("i",{staticClass:"fa fa-star",class:[{"fill-current":a<=t.calStar(e.item.rating,e.item.ratingCount)},a<=t.calStar(e.item.rating,e.item.ratingCount)?"text-warning":"text-muted"]})])})),0)])]}},{key:"cell(catagory)",fn:function(e){return[s("div",{staticClass:"pro-catagory"},[t._v(" "+t._s(t.formatCatagory(e.item.catagory))+" ")])]}},{key:"cell(type)",fn:function(e){return[s("div",{staticClass:"pro-type"},[""==e.item.productType?s("span",[t._v("-")]):t._e(),"สินค้าขายดี"==e.item.productType?s("div",[s("b-badge",{staticClass:"status-check-style",attrs:{pill:""}},[t._v("สินค้าขายดี")])],1):t._e(),"สินค้าแนะนำ"==e.item.productType?s("span",[s("b-badge",{staticClass:"status-wait-style",attrs:{pill:""}},[t._v("สินค้าแนะนำ")])],1):t._e()])]}},{key:"cell(price)",fn:function(e){return[s("div",{staticClass:"pro-price"},[e.item.discount?t._e():s("div",[t._v(" "+t._s(t.formatPrice(e.item.price))+" บาท ")]),e.item.discount?s("div",[s("div",{staticClass:"font-dis"},[t._v(" "+t._s(t.formatPrice(e.item.price))+" บาท ")]),s("div",[t._v(t._s(t.formatPrice(e.item.sale))+" บาท")])]):t._e()])]}},{key:"cell(stock)",fn:function(e){return[s("div",{staticClass:"pro-stock"},[0==e.item.stock?s("span",{staticClass:"wern-text"},[s("b-badge",{staticClass:"status-cancle-style",attrs:{pill:""}},[t._v("สินค้าหมด")])],1):t._e(),e.item.stock<10&&0!=e.item.stock?s("span",{staticClass:"wern-text"},[s("AlertTriangleIcon",{staticClass:"mr-1 mb-1",attrs:{size:"20"}}),t._v(t._s(e.item.stock)+" ชิ้น")],1):t._e(),e.item.stock>=10?s("span",[t._v(t._s(e.item.stock)+" ชิ้น")]):t._e()])]}},{key:"cell(actions)",fn:function(e){return[s("b-dropdown",{staticClass:"dropdown-right",attrs:{size:"md",variant:"link",right:"","no-caret":""},scopedSlots:t._u([{key:"button-content",fn:function(){return[s("i",{staticClass:"fa fa-ellipsis-v",attrs:{color:"#7367f0"}})]},proxy:!0}],null,!0)},[s("b-dropdown-item",{on:{click:function(a){return t.getDetail(e.item)}}},[s("i",{staticClass:"fa fa-search"}),t._v(" รายละเอียด")]),s("b-dropdown-item",{on:{click:function(a){return t.toggleModal("edit",e.item)}}},[s("i",{staticClass:"fa fa-edit"}),t._v(" แก้ไข")]),s("b-dropdown-item",{on:{click:function(a){return t.toggleModal("delete",e.item)}}},[s("i",{staticClass:"fa fa-trash"}),t._v(" ลบ")])],1)]}}],null,!1,2389464879)})],1),0!=t.products.length?s("div",{staticClass:"mx-2"},[s("b-row",[s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-start\n            ",attrs:{cols:"12",sm:"6"}},[s("span",{staticClass:"text-mute total-data"},[t._v("สินค้าที่ "+t._s(t.itemStart)+" - "+t._s(t.itemEnd)+" จาก "+t._s(t.totalDatas))])]),s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-end\n            ",attrs:{cols:"12",sm:"6"}},[s("Pagination",{attrs:{currentPage:this.$store.state.currentP+1,totalItem:t.totalDatas,itemPerPage:t.itemPerPage,start:t.itemStart,end:t.itemEnd},on:{selectedPage:t.loadMore}})],1)],1)],1):t._e()],1)]),s("b-modal",{staticClass:"modalClass product-modal",attrs:{id:"modal-1",title:"add"==t.formMode?"เพิ่มสินค้า":"แก้ไขสินค้า","hide-footer":"",size:"lg"}},[[s("validation-observer",{ref:"Rules"},[s("b-form",{on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[s("b-card-text",{staticClass:"text-small text-mute mt-1"},[s("i",{staticClass:"fa fa-info-circle mr-2"}),t._v("รูปภาพขนาดไม่เกิน 0.8 mb (800*800 พิกเซล)")]),s("b-row",[s("b-col",{staticClass:"mb-2",attrs:{cols:"12",lg:"3",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"รูปสินค้า","label-for":"product-image"}},[s("div",{staticClass:"itemsContainer"},[s("div",{staticClass:"image"},[s("b-img",{ref:"refPreviewEl",staticClass:"\n                        rounded\n                        mr-2\n                        mb-1 mb-md-0\n                        custom-show-img-table\n                        img-border\n                      ",attrs:{src:t.preview?t.preview:a("c548"),height:"120",width:"120"},on:{click:function(e){return t.$refs.refInputEl.$el.click()}}})],1),s("div",{staticClass:"play"},[s("UploadIcon",{staticClass:"pointer",attrs:{size:"35"},on:{click:function(e){return t.$refs.refInputEl.$el.click()}}})],1)]),s("ValidationProvider",{attrs:{name:"Image",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-file",{ref:"refInputEl",attrs:{accept:".jpg, .png",hidden:!0,plain:"",state:!(a.length>0)&&null},on:{input:t.pickFile},model:{value:t.form.image,callback:function(e){t.$set(t.form,"image",e)},expression:"form.image"}}),s("small",{staticClass:"text-danger d-lg-inline-block d-md-flex"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"9",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ชื่อสินค้า","label-for":"product-name"}},[s("ValidationProvider",{attrs:{name:"Name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-input",{attrs:{id:"product-name",placeholder:"กรอกชื่อสินค้า",autocomplete:"off",state:!(a.length>0)&&null},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"12"}},[s("b-row",[s("b-col",{attrs:{lg:"8",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"รายละเอียดสินค้า","label-for":"product-detail"}},[s("b-form-textarea",{staticClass:"cus-text-area",attrs:{id:"product-detail",rows:"3",placeholder:"กรอกรายละเอียดของสินค้า"},model:{value:t.form.detail,callback:function(e){t.$set(t.form,"detail",e)},expression:"form.detail"}})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-row",[s("b-col",{attrs:{lg:"12",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"รหัสสินค้า","label-for":"product-id"}},[s("b-form-input",{attrs:{id:"product-code",placeholder:"กรอกรหัสสินค้า",autocomplete:"off",disabled:""},model:{value:t.form.productID,callback:function(e){t.$set(t.form,"productID",e)},expression:"form.productID"}})],1)],1),s("b-col",{attrs:{lg:"12",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"แสดงสินค้า","label-for":"product-show"}},[s("b-form-checkbox",{attrs:{id:"product-show",switch:""},model:{value:t.form.show,callback:function(e){t.$set(t.form,"show",e)},expression:"form.show"}})],1)],1)],1)],1)],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ยี่ห้อ","label-for":"product-brand"}},[s("b-form-input",{attrs:{id:"product-brand",placeholder:"ยี่ห้อสินค้า",autocomplete:"off"},model:{value:t.form.brand,callback:function(e){t.$set(t.form,"brand",e)},expression:"form.brand"}})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"หมวดหมู่","label-for":"product-catagory"}},[s("ValidationProvider",{attrs:{name:"Catagory",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-select",{attrs:{id:"product-type",options:t.catagorys,state:!(a.length>0)&&null},model:{value:t.form.catagory,callback:function(e){t.$set(t.form,"catagory",e)},expression:"form.catagory"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ประเภทสินค้า","label-for":"product-type"}},[s("b-select",{attrs:{id:"product-type",options:t.productTypes},model:{value:t.form.productType,callback:function(e){t.$set(t.form,"productType",e)},expression:"form.productType"}})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ราคาสินค้า (บาท)","label-for":"product-price"}},[s("ValidationProvider",{attrs:{name:"Price",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-input",{attrs:{id:"product-total",type:"number",placeholder:"กรอกราคาสินค้า",min:"0",autocomplete:"off",state:!(a.length>0)&&null},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",t._n(e))},expression:"form.price"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ลดราคา","label-for":"product-discount"}},[s("b-form-checkbox",{attrs:{id:"product-discount",switch:""},model:{value:t.form.discount,callback:function(e){t.$set(t.form,"discount",e)},expression:"form.discount"}})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"ราคาที่เหลือ","label-for":"product-sale"}},[t.form.discount?s("b-form-input",{attrs:{id:"product-sale",type:"number",placeholder:"กรอกราคาที่เหลือ",min:"0",autocomplete:"off"},model:{value:t.form.sale,callback:function(e){t.$set(t.form,"sale",t._n(e))},expression:"form.sale"}}):t._e(),t.form.discount?t._e():s("b-form-input",{attrs:{id:"product-sale",type:"number",disabled:"",autocomplete:"off"},model:{value:t.form.sale,callback:function(e){t.$set(t.form,"sale",e)},expression:"form.sale"}})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"สต๊อกสินค้า","label-for":"product-stock"}},[s("ValidationProvider",{attrs:{name:"Stock",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-input",{attrs:{type:"number",id:"product-stock",placeholder:"กรอกสต๊อกสินค้า",autocomplete:"off",min:"0",state:!(a.length>0)&&null},model:{value:t.form.stock,callback:function(e){t.$set(t.form,"stock",t._n(e))},expression:"form.stock"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"วันหมดอายุ","label-for":"product-stock"}},[s("ValidationProvider",{attrs:{name:"Product EXP",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-input",{attrs:{id:"product-exp",placeholder:"กรอกวันหมดอายุสินค้า",autocomplete:"off",state:!(a.length>0)&&null},model:{value:t.form.productEXP,callback:function(e){t.$set(t.form,"productEXP",t._n(e))},expression:"form.productEXP"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),s("b-col",{attrs:{lg:"4",md:"12"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"น้ำหนัก (กรัม:หน่วย)","label-for":"product-weight"}},[s("ValidationProvider",{attrs:{name:"Weight",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.errors;return[s("b-form-input",{attrs:{type:"number",id:"product-weight",placeholder:"น้ำหนักสินค้า",min:"0",state:!(a.length>0)&&null,autocomplete:"off"},model:{value:t.form.weight,callback:function(e){t.$set(t.form,"weight",t._n(e))},expression:"form.weight"}}),s("small",{staticClass:"text-danger"},[t._v(t._s(a[0]))])]}}])})],1)],1),t._l(t.form.moreImages,(function(e,r){return s("b-col",{key:r,staticClass:"mt-2",attrs:{lg:"3",md:"4",cols:"4"}},[s("b-form-group",{staticClass:"mb-2",attrs:{label:"รูปภาพเพิ่มเติม "+(r+1),"label-for":"more-image"}},[s("div",{staticClass:"itemsContainer"},[s("div",{staticClass:"image"},[s("b-img",{ref:"refPreviewEl",refInFor:!0,staticClass:"\n                        rounded\n                        mr-2\n                        mb-1 mb-md-0\n                        custom-show-img-table\n                        img-border\n                      ",attrs:{src:e.preview?e.preview:a("c548"),height:"120",width:"120"},on:{click:function(e){return t.selectFile("refInputEl"+r)}}})],1),s("div",{staticClass:"play"},[s("UploadIcon",{staticClass:"pointer",attrs:{size:"35"},on:{click:function(e){return t.selectFile("refInputEl"+r)}}})],1)]),s("b-form-file",{ref:"refInputEl"+r,refInFor:!0,attrs:{accept:".jpg, .png",hidden:!0,plain:""},on:{input:function(e){return t.pickFileMore("refInputEl"+r,r)}},model:{value:e.image,callback:function(a){t.$set(e,"image",a)},expression:"image.image"}})],1)],1)})),s("b-col",{staticClass:"mt-2",attrs:{md:"12"}},[s("div",{staticClass:"text-center pt-2 pb-2"},[t.form.moreImages.length<3?s("b-button",{staticClass:"mr-2",attrs:{variant:"outline-success"},on:{click:t.addMoreImage}},[t._v("เพิ่มรูปภาพ "),s("i",{staticClass:"fa fa-plus"})]):t._e(),t.form.moreImages.length>0?s("b-button",{attrs:{variant:"outline-danger"},on:{click:t.removeMoreImage}},[t._v("ลบรูปภาพ "),s("i",{staticClass:"fa fa-times"})]):t._e()],1)]),s("b-col",{staticClass:"mt-3",attrs:{cols:"12"}},[s("b-button",{staticClass:"mr-1",attrs:{variant:"primary",type:"submit"}},[t._v(" บันทึก ")]),s("b-button",{attrs:{variant:"outline-primary"},on:{click:t.closeModal}},[t._v(" ยกเลิก ")])],1)],2)],1)],1)]],2),s("b-modal",{attrs:{id:"modal-delete","hide-footer":"",size:"md",title:"ลบสินค้า"}},[[s("div",{staticClass:"center"},[t._v("แน่ใจหรือว่าต้องการลบสินค้านี้ ?")]),s("div",{staticClass:"btn-delete text-center mt-2"},[s("b-row",[s("b-col",{staticClass:"mt-2 mb-2",attrs:{cols:"12"}},[s("b-button",{staticClass:"mr-1",attrs:{variant:"primary"},on:{click:t.deleteData}},[t._v("ยืนยัน")]),s("b-button",{attrs:{variant:"outline-primary"},on:{click:t.toggleModalDelete}},[t._v("ยกเลิก")])],1)],1)],1)]],2)],1)},r=[],o=a("28f7"),i=a("68ee"),l=a("6407"),c=a("c1df"),n=a.n(c),d=a("7bb1"),m=a("ae39"),u=a("0a35"),p=(a("78a7"),{name:"product",components:{VclTable:i["VclTable"],Pagination:l["a"],AlertTriangleIcon:u["a"],ValidationProvider:d["b"],ValidationObserver:d["a"],UploadIcon:u["t"]},data(){return{required:m["b"],products:[],loading:!1,preview:"",itemSelected:{},formMode:"",perPageOptions:["25","50","75"],totalDatas:null,itemPerPage:25,itemStart:null,itemEnd:null,form:{name:"",image:"",productID:"",brand:"",stock:null,productType:"",catagory:"",weight:null,productEXP:"",discount:!1,detail:"",price:null,sale:null,moreImages:[]},defaultImage:"",searchQuery:"",catagorys:["คุกกี้ บิสกิต","ช็อกโกแลต","ลูกอม เยลลี่","โมจิ","มาร์ชแมลโลว์","มันฝรั่ง ถั่ว ธัญพืช","น้ำผลไม้","น้ำอัดลม","ชา กาแฟ","สาหร่าย","ข้าวเกรียบ","อาหารแปรรูป","บะหมี่กึ่งสำเร็จรูป","อื่นๆ"],productTypes:["","สินค้าขายดี","สินค้าแนะนำ"],catagorySelected:"ทั้งหมด",catagorysFilter:["ทั้งหมด","คุกกี้ บิสกิต","ช็อกโกแลต","ลูกอม เยลลี่","โมจิ","มาร์ชแมลโลว์","มันฝรั่ง ถั่ว ธัญพืช","น้ำผลไม้","น้ำอัดลม","ชา กาแฟ","สาหร่าย","ข้าวเกรียบ","อาหารแปรรูป","บะหมี่กึ่งสำเร็จรูป","อื่นๆ"],typeSelected:"ทั้งหมด",typeFilter:["ทั้งหมด","สินค้าขายดี","สินค้าแนะนำ"],fields:[{key:"image"},{key:"name",sortable:!0},{key:"catagory",sortable:!0},{key:"type",sortable:!0},{key:"price",sortable:!0},{key:"stock",sortable:!0},{key:"actions"}],nextProductID:"KJ00001"}},created(){this.loadProduct()},methods:{loadProduct(){this.loading=!0;let t=this.itemPerPage*this.$store.state.currentP;const e=o["a"].firestore().collection("products");var a;return a="ทั้งหมด"!=this.catagorySelected?""!=this.searchQuery&&"ทั้งหมด"!=this.typeSelected?e.where("catagory","==",this.catagorySelected).where("productType","==",this.typeSelected).where("name",">=",this.searchQuery).where("name","<=",this.searchQuery+""):""!=this.searchQuery&&"ทั้งหมด"==this.typeSelected?e.where("catagory","==",this.catagorySelected).where("name",">=",this.searchQuery).where("name","<=",this.searchQuery+""):""==this.searchQuery&&"ทั้งหมด"!=this.typeSelected?e.where("catagory","==",this.catagorySelected).where("productType","==",this.typeSelected):e.where("catagory","==",this.catagorySelected).orderBy("createAt","desc"):""!=this.searchQuery&&"ทั้งหมด"!=this.typeSelected?e.where("productType","==",this.typeSelected).where("name",">=",this.searchQuery).where("name","<=",this.searchQuery+""):""!=this.searchQuery&&"ทั้งหมด"==this.typeSelected?e.where("name",">=",this.searchQuery).where("name","<=",this.searchQuery+""):""==this.searchQuery&&"ทั้งหมด"!=this.typeSelected?e.where("productType","==",this.typeSelected):e.orderBy("createAt","desc"),a.get().then(e=>{let s=e.docs[t];var r=e.docs.length,o=this.$store.state.currentP+1,i=o*this.itemPerPage-(this.itemPerPage-1),l=Math.min(i+this.itemPerPage-1,r);if(this.itemStart=i,this.itemEnd=l,this.totalDatas=r,s)var c=a.startAt(s).limit(this.itemPerPage);else c=a.limit(this.itemPerPage);c.get().then(t=>{var e=[];t.forEach(t=>{var a={uid:t.id,name:t.data().name,price:t.data().price,sale:t.data().sale,discount:t.data().discount,catagory:t.data().catagory,productID:t.data().productID,stock:t.data().stock,productType:t.data().productType,brand:t.data().brand,image:t.data().image,detail:t.data().detail,productEXP:t.data().productEXP,sold:t.data().sold,rating:t.data().rating,show:!!t.data().show&&t.data().show,ratingCount:t.data().ratingCount,weight:t.data().weight,createAt:t.data().createAt,updateAt:t.data().updateAt,moreImage:t.data().moreImage};e.push(a)}),this.loading=!1,this.products=e,this.lastestProduct()}).catch(t=>{this.loading=!1,console.log(t)})}).catch(t=>{this.loading=!1,console.log(t)})},lastestProduct(){const t=o["a"].firestore().collection("products");t.orderBy("createAt","desc").limit(1).get().then(t=>{t.forEach(t=>{var e=t.data().productID,a=e.substring(2,7),s=parseInt(a)+1,r=s.toString().length;1==r?this.nextProductID="KJ0000"+s:2==r?this.nextProductID="KJ000"+s:3==r?this.nextProductID="KJ00"+s:4==r&&(this.nextProductID="KJ0"+s)})})},getDetail(t){this.$router.push("/admin/product/"+t.uid)},changeItemPerPage(t){this.itemPerPage=t,this.loadProduct()},loadMore(t){this.$store.dispatch("changePage",t),this.loadProduct()},toggleModal(t,e){if(this.formMode=t,"edit"==t){var a=[];e.moreImage.forEach(t=>{var e={preview:t||"",image:t||""};a.push(e)}),this.form={id:e.uid,name:e.name,price:e.price,discount:e.discount,productType:e.productType,sale:e.sale,image:e.image,detail:e.detail,productEXP:e.productEXP,catagory:e.catagory,weight:e.weight,stock:e.stock,show:e.show,brand:e.brand,productID:e.productID,moreImages:a},this.preview=e.image,this.itemSelected=e,this.$bvModal.show("modal-1")}else"add"==t?(this.form={name:"",image:"",productID:this.nextProductID,brand:"",stock:null,weight:null,productType:"",catagory:"",productEXP:"",discount:!1,detail:"",show:!0,price:null,sale:null,moreImages:[]},this.preview="",this.$bvModal.show("modal-1")):"delete"==t&&(this.itemSelected=e,this.$bvModal.show("modal-delete"))},toggleModalDelete(){this.$bvModal.hide("modal-delete")},pickFile(){let t=this.$refs.refInputEl,e=t.files;if(this.fileUpload=e[0],this.fileUpload.size<8e5&&e&&e[0]){let t=new FileReader;t.onload=t=>{this.preview=t.target.result},t.readAsDataURL(e[0]),this.form.image=e[0]}},closeModal(){this.$bvModal.hide("modal-1")},addData(t){this.loading=!0;var e=[];t.moreImages.forEach(t=>{if("object"===typeof t.image){var a=this.uploadImageAsPromise(t.image);e.push(a)}else""!=t.image&&e.push(t.image)}),Promise.all(e).then(e=>{var a={name:t.name,price:t.price,sale:t.sale,stock:t.stock,catagory:t.catagory,discount:t.discount,detail:t.detail,productID:t.productID,brand:t.brand,weight:t.weight,sold:0,rating:0,ratingCount:0,ratingSearch:0,show:t.show,productEXP:t.productEXP,productType:t.productType,updateAt:new Date,createAt:new Date,moreImage:e},s=t.image;if(""!=s){var r=new Date;const t=r.valueOf().toString();o["a"].storage().ref("imageProduct").child(t).put(s).then(t=>{t.ref.getDownloadURL().then(t=>{a.image=t;const e=o["a"].firestore().collection("products");return e.add(a).then(()=>{this.loading=!1,this.$toast.success("เพิ่มสินค้าเรียบร้อย",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-check-circle"}),this.loadProduct()}).catch(t=>{this.loading=!1,this.$toast.error("เพิ่มสินค้าไม่สำเร็จ",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-exclamation-triangle"}),console.log(t)})})})}else this.loading=!1})},editData(t){this.loading=!0;var e=[];t.moreImages.forEach(t=>{if("object"===typeof t.image){var a=this.uploadImageAsPromise(t.image);e.push(a)}else""!=t.image&&e.push(t.image)}),Promise.all(e).then(e=>{this.itemSelected.moreImage.map((t,a)=>{t!=e[a]&&""!=t&&this.deleteOldImage(t)});var a={name:t.name,discount:t.discount,price:t.price,sale:t.sale,stock:t.stock,catagory:t.catagory,productID:t.productID,brand:t.brand,weight:t.weight,show:t.show,productEXP:t.productEXP,productType:t.productType,detail:t.detail,updateAt:new Date,moreImage:e},s=t.image;if(""!=s&&s!=this.itemSelected.image){var r=new Date;const e=r.valueOf().toString();o["a"].storage().ref("imageProduct").child(e).put(s).then(e=>{e.ref.getDownloadURL().then(e=>{a.image=e,this.deleteOleImage(),this.updateData(a,t.id)})}).catch(t=>{console.log(t),this.loading=!1})}else a.image=t.image,this.updateData(a,t.id)})},updateData(t,e){const a=o["a"].firestore().doc("products/"+e);return a.update(t).then(()=>{this.loading=!1,this.$toast.success("แก้ไขสินค้าเรียบร้อย",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-check-circle"}),this.loadProduct()}).catch(t=>{this.loading=!1,this.$toast.error("แก้ไขสินค้าไม่สำเร็จ",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-exclamation-triangle"}),console.log(t)})},deleteData(){this.loading=!0,this.$bvModal.hide("modal-delete"),this.itemSelected.moreImage.map(t=>{""!=t&&this.deleteOldImage(t)}),this.deleteOleImage();const t=o["a"].firestore().doc("products/"+this.itemSelected.uid);return t.delete().then(()=>{this.loading=!1,this.$toast.success("ลบสินค้าเรียบร้อย",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-check-circle"}),this.loadProduct()}).catch(t=>{this.loading=!1,this.$toast.error("ลบสินค้าไม่สำเร็จ",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-exclamation-triangle"}),console.log(t)})},deleteOleImage(){const t=this.itemSelected.image;t&&o["a"].storage().refFromURL(t).delete()},searchProduct(){this.loadProduct()},submit(){this.$refs.Rules.validate().then(t=>{t&&("add"==this.formMode?this.addData(this.form):this.editData(this.form),this.$bvModal.hide("modal-1"))})},formatDate(t){var e=t.toDate(),a=n()(e).format("DD-MM-YYYY");return a},formatPrice(t){let e=(t/1).toFixed(0);return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},formatCatagory(t){var e=t;return e.replace(/\s/g,", ")},changeCatagory(t){this.catagorySelected=t,this.loadProduct()},changeType(t){this.typeSelected=t,this.loadProduct()},calStar(t,e){return(t/e).toFixed(1)},addMoreImage(){this.form.moreImages.length<3&&this.form.moreImages.push({preview:"",image:""})},removeMoreImage(){this.form.moreImages.length>0&&this.form.moreImages.pop()},selectFile(t){this.$refs[t][0].$el.click()},pickFileMore(t,e){let a=this.$refs[t][0],s=a.files;if(this.fileUpload=s[0],this.fileUpload.size<8e5&&s&&s[0]){let t=new FileReader;t.onload=t=>{this.form.moreImages[e].preview=t.target.result},t.readAsDataURL(s[0]),this.form.moreImages[e].image=s[0]}},deleteOldImage(t){o["a"].storage().refFromURL(t).delete()},rowClass(t){return 1==t.show?"showItem":"notShowItem"},uploadImageAsPromise(t){return new Promise((function(e,a){let s=(Math.random().toString(36).substring(2,16)+Math.random().toString(36).substring(2,16)).toUpperCase();var r=o["a"].storage().ref("/imageProduct/"+s),i=r.put(t);i.on("state_changed",(function(t){var e=t.bytesTransferred/t.totalBytes*100;console.log("percentage"+e)}),(function(t){console.log(t),a(t)}),(function(){var t=i.snapshot.ref.getDownloadURL();e(t)}))}))}}}),g=p,f=(a("a997"),a("2877")),h=Object(f["a"])(g,s,r,!1,null,"6b4d1c80",null);e["default"]=h.exports},6407:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"overflow-auto"},[a("div",{staticClass:"pagination-item"},[a("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},on:{input:function(e){return t.updatePage(t.currentPage)}},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)])},r=[],o={name:"Pagination",props:["currentPage","totalItem","itemPerPage","start","end"],data(){return{perPage:this.itemPerPage}},methods:{updatePage(t){this.$emit("selectedPage",t-1)}},computed:{rows(){return this.totalItem}}},i=o,l=(a("30b0"),a("2877")),c=Object(l["a"])(i,s,r,!1,null,"62654af7",null);e["a"]=c.exports},a997:function(t,e,a){"use strict";a("f432")},c548:function(t,e,a){t.exports=a.p+"img/NoImage.4963814d.png"},f432:function(t,e,a){}}]);
//# sourceMappingURL=chunk-d5e20646.c8aa900e.js.map