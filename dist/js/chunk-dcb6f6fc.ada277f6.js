(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dcb6f6fc"],{"0382":function(e,t,a){"use strict";a("9f07")},"09ea":function(e,t,a){e.exports=a.p+"img/empty_cart.5d005a6d.svg"},"0d14":function(e,t,a){},1020:function(e,t,a){"use strict";a("49c2")},"34e4":function(e,t,a){"use strict";a("0d14")},"49c2":function(e,t,a){},"78c6":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"qr-promptpay",domProps:{innerHTML:e._s(e.qrString)}})},r=[],i=a("d87c"),o=a.n(i),l=a("d055"),n=a.n(l),d={props:{id:{type:String,required:!0},amount:{type:Number,required:!0}},data(){return{qrString:""}},watch:{id(e){e&&this.generateSvg()},amount(e){e&&this.generateSvg()}},methods:{generateSvg(){n.a.toString(o()(this.id,{amount:this.amount}),{type:"svg",errorCorrectionLevel:"L"},(e,t)=>{e?window.alert("Cannot generate QR code: "+String(e)):this.qrString=t})}},mounted(){this.generateSvg()}},c=d,u=a("2877"),m=Object(u["a"])(c,s,r,!1,null,null,null);t["a"]=m.exports},"9f07":function(e,t,a){},b38a:function(e,t,a){"use strict";a("f963")},bff8:function(e,t,a){"use strict";a("d652")},c45e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-overlay",{staticClass:"setOverlay",attrs:{show:e.showOverlay,rounded:"sm"}},[s("div",{staticClass:"list-view product-checkout-all mt-0"},[0==e.$store.state.cartItems.length?s("div",{staticClass:"text-center non-cart p-4"},[s("h4",{staticClass:"mb-4"},[e._v("ไม่พบรายการสินค้า")]),s("img",{staticClass:"mt-4",attrs:{src:a("09ea"),width:"400px"}})]):e._e(),0!=e.$store.state.cartItems.length?s("div",{staticClass:"wizard-checkout-items"},[s("div",{staticClass:"icon-title-wizard"},[s("div",{staticClass:"checkout-title"},[e._v("ยืนยันคำสั่งซื้อ")]),s("div",{staticClass:"text-right row"},[s("b-col",{attrs:{lg:"8"}},[s("span",{staticClass:"pr-3"},[e._v(" Step "+e._s(e.step)+" / 4 ")])])],1)]),s("form-wizard",{ref:"refFormWizard",staticClass:"checkout-form-wizard steps-transparent",attrs:{color:"#7367F0",title:null,subtitle:null,"finish-button-text":"Submit","back-button-text":"Previous","hide-buttons":""}},[s("tab-content",{attrs:{title:"รถเข็น",icon:"fas fa-shopping-cart"}},[s("CheckoutCart",{attrs:{role:e.role},on:{"next-step":e.formWizardNextStep,"update-step":e.updateStep}})],1),s("tab-content",{attrs:{title:"ที่อยู่",icon:"fa fa-map-marker-alt"}},[s("CheckoutAddress",{attrs:{addressDetails:e.userData},on:{updataAddress:e.updateAddress,"next-step":e.formWizardNextStep,"prev-step":e.formWizardPrevStep,addressData:e.addressData,"update-step":e.updateStep,changDataAddress:e.changDataAddress}})],1),s("tab-content",{attrs:{title:"ขนส่ง",icon:"fa fa-truck-loading"}},[s("CheckoutDeliver",{on:{"next-step":e.formWizardNextStep,"prev-step":e.formWizardPrevStep,"update-step":e.updateStep}})],1),s("tab-content",{attrs:{title:"ชำระเงิน",icon:"fa fa-credit-card"}},[s("CheckoutPayment",{on:{"next-step":e.formWizardNextStep,"prev-step":e.formWizardPrevStep,"save-later":e.saveDataOrder,"save-confirm":e.saveDataConfirm,"update-step":e.updateStep}})],1)],1)],1):e._e()])])},r=[],i=a("2ee4"),o=a("28f7"),l=(a("78a7"),a("a6f4")),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[0!=e.$store.state.cartItems.length?a("div",{staticClass:"list-view product-checkout"},[a("div",{staticClass:"product-list"},[e._l(e.$store.state.cartItems,(function(t,s){return a("b-card",{key:s,staticClass:"ecommerce-card-checkout mb-4",attrs:{"no-body":""}},[a("div",{staticClass:"item-img text-center item"},[a("div",{staticClass:"itemType pointer",on:{click:function(a){return e.toDetailPage(t.id)}}},["สินค้าขายดี"==t.productType?a("div",{staticClass:"img-badge-mini good-sold"},[e._v(" "+e._s(t.productType)+" ")]):e._e(),"สินค้าแนะนำ"==t.productType?a("div",{staticClass:"img-badge-mini recommend"},[e._v(" "+e._s(t.productType)+" ")]):e._e(),a("b-img",{staticClass:"card-img-top",attrs:{fluid:"",src:t.image}})],1)]),a("b-card-body",{staticClass:"info pl-2 pr-2"},[a("h6",{staticClass:"item-name"},[a("b-link",{staticClass:"text-body",on:{click:function(a){return e.toDetailPage(t.id)}}},[a("div",{staticClass:"item-name pro-name"},[e._v(" "+e._s(t.name)+" ")])])],1),a("div",{staticClass:"text-small pro-id"},[e._v(e._s(t.productID))]),a("div",{staticClass:"mb-1"},[e._v("คลัง : "+e._s(t.stock))]),a("div",{staticClass:"cart-item-qty"},[a("span",{staticClass:"mr-2"},[e._v("จำนวน")]),a("b-form-spinbutton",{class:t.qty==t.stock?"max-qty":"unmax-qty",attrs:{min:"1",size:"sm",max:t.stock},on:{change:function(a){return e.changeQTY(t.qty,s)}},model:{value:t.qty,callback:function(a){e.$set(t,"qty",a)},expression:"item.qty"}})],1)]),a("div",{staticClass:"item-options text-center"},[a("div",{staticClass:"item-wrapper"},[a("div",{staticClass:"item-cost"},[t.discount?a("div",{staticClass:"font-dis-detail"},[e._v(" "+e._s(e.formatPrice(t.fullprice*t.qty))+" THB ")]):e._e(),a("h5",{staticClass:"item-price"},[e._v(" "+e._s(e.formatPrice(t.price*t.qty))+" THB ")])])]),a("b-button",{staticClass:"mt-1 remove",attrs:{variant:"light"},on:{click:function(t){return e.removeItemFromCart(s)}}},[a("i",{staticClass:"fa fa-times"}),a("span",{staticClass:"ml-2"},[e._v("ลบ")])])],1)],1)})),"user"==e.role?a("div",{staticClass:"text-right mb-4"},[a("b-button",{attrs:{variant:"primary"},on:{click:function(t){return e.nextStep()}}},[e._v("เลือกที่อยู่ "),a("i",{staticClass:"fa fa-angle-right"})])],1):e._e(),""==e.role?a("div",{staticClass:"text-right mb-4"},[a("b-alert",{attrs:{show:"",variant:"warning"}},[a("div",{staticClass:"bold"},[e._v("ยังไม่ได้เข้าสู่ระบบ")]),a("div",[e._v("กรุณาเข้าสู่ระบบเพื่อดําเนินการต่อ")])])],1):e._e()],2),0!=e.$store.state.cartItems.length?a("div",[a("TotalPrice")],1):e._e()]):e._e()])},d=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"checkout-options"},[a("b-card",{staticClass:"priceDetail"},[a("label",{staticClass:"section-label mb-1"},[e._v("รายละเอียดราคา")]),a("hr"),a("div",{staticClass:"price-details"},[a("h6",{staticClass:"price-title"}),a("ul",{staticClass:"list-unstyled"},[a("li",{staticClass:"price-detail"},[a("div",{staticClass:"detail-title"},[e._v("จำนวนสินค้า")]),a("div",{staticClass:"detail-amt"},[e._v(e._s(e.$store.state.itemCartCount)+" รายการ")])]),a("li",{staticClass:"price-detail"},[a("div",{staticClass:"detail-title"},[e._v("ราคาสินค้ารวม")]),a("div",{staticClass:"detail-amt"},[e._v(e._s(e.formatPrice(e.$store.state.totalPrice))+" บาท")])]),a("li",{staticClass:"price-detail"},[a("div",{staticClass:"detail-title"},[e._v("ค่าจัดส่ง")]),null==e.$store.state.deliverCompany.price?a("div",{staticClass:"detail-amt discount-amt"},[e._v(" ยังไม่คำนวณ")]):e._e(),null!=e.$store.state.deliverCompany.price?a("div",{staticClass:"detail-amt discount-amt-calc"},[0!=e.$store.state.deliverCompany.price?a("span",[e._v(e._s(e.formatPrice(e.$store.state.deliverCompany.price))+" บาท")]):e._e(),0==e.$store.state.deliverCompany.price?a("span",[e._v("ฟรี")]):e._e()]):e._e()])]),a("hr"),a("ul",{staticClass:"list-unstyled"},[a("li",{staticClass:"price-detail all"},[a("div",{staticClass:"detail-title detail-total bold"},[e._v("ยอดรวม")]),a("div",{staticClass:"detail-amt font-weight-bolder"},[e._v(e._s(e.formatPrice(e.$store.state.totalPrice+e.$store.state.deliverCompany.price))+" บาท")])])])])])],1)},u=[],m={name:"totalPrice",methods:{formatPrice(e){let t=(e/1).toFixed(0);return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}}},p=m,v=(a("1020"),a("2877")),f=Object(v["a"])(p,c,u,!1,null,null,null),h=f.exports,b={name:"CheckoutCart",components:{TotalPrice:h},props:["role"],methods:{nextStep(){this.$emit("next-step"),this.$emit("update-step",2)},removeItemFromCart(e){this.$store.dispatch("removeItemCart",e)},formatPrice(e){let t=(e/1).toFixed(0);return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},changeQTY(e,t){var a={qty:e,index:t};this.$store.dispatch("changeItemQty",a)},toDetailPage(e){this.$router.push("/product-detail/"+e)}},data(){return{}}},C=b,g=(a("34e4"),Object(v["a"])(C,n,d,!1,null,"3726641d",null)),y=g.exports,_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-form",{staticClass:"list-view product-checkout",on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[a("div",{staticClass:"customer-card"},[a("b-card",{staticClass:"mb-4"},[a("b-card-text",{staticClass:"mb-3",on:{click:function(t){return e.changeAddress("old")}}},[a("b-form-radio",{class:e.firstCollapsed?"address-use":"address-not-use",attrs:{value:"old"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[e._v(" ใช้ที่อยู่ปัจจุบัน ")])],1),e.firstCollapsed?a("div",{staticClass:"text-center mt-2 mb-2 saveAddress"},[a("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"pointer",attrs:{size:"sm",variant:"outline-success",title:"อัปเดตที่อยู่ปัจจุบัน"},on:{click:e.updateAddress}},[a("SaveIcon")],1)],1):e._e(),a("validation-observer",{ref:"Rules"},[a("b-collapse",{model:{value:e.firstCollapsed,callback:function(t){e.firstCollapsed=t},expression:"firstCollapsed"}},[a("b-row",[a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"Name",label:"ชื่อ-สกุล"}},[a("ValidationProvider",{attrs:{name:"Name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"Name",placeholder:"กรอกชื่อ-สกุล",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.addressDetails.name,callback:function(t){e.$set(e.addressDetails,"name",t)},expression:"addressDetails.name"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"Phone",label:"เบอร์โทรศัพท์"}},[a("ValidationProvider",{attrs:{name:"Phone",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-input-group",[a("cleave",{staticClass:"form-control",class:s.length>0?"non-valid":"valid",attrs:{id:"phone",raw:!1,options:e.optionsMark.phoneNumber,placeholder:"08x xxx xxxx"},model:{value:e.addressDetails.phone,callback:function(t){e.$set(e.addressDetails,"phone",t)},expression:"addressDetails.phone"}})],1),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"3"}},[a("b-form-group",{attrs:{"label-for":"houseNumber",label:"บ้านเลขที่"}},[a("ValidationProvider",{attrs:{name:"houseNumber",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"houseNumber",placeholder:"กรอกบ้านเลขที่",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.addressDetails.houseNumber,callback:function(t){e.$set(e.addressDetails,"houseNumber",t)},expression:"addressDetails.houseNumber"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"3"}},[a("b-form-group",{attrs:{"label-for":"soy",label:"ซอย"}},[a("ValidationProvider",{attrs:{name:"Soy",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"soy",placeholder:"กรอกซอย",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.addressDetails.soy,callback:function(t){e.$set(e.addressDetails,"soy",t)},expression:"addressDetails.soy"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"road",label:"ถนน"}},[a("ValidationProvider",{attrs:{name:"Road",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"road",placeholder:"กรอกชื่อถนน",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.addressDetails.road,callback:function(t){e.$set(e.addressDetails,"road",t)},expression:"addressDetails.road"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"district",label:"ตำบล/แขวง"}},[a("ValidationProvider",{attrs:{name:"District",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"district",color:"#7367f0",size:"default",placeholder:"ตำบล/แขวง"},on:{select:e.select},model:{value:e.addressDetails.district,callback:function(t){e.$set(e.addressDetails,"district",t)},expression:"addressDetails.district"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"amphoe",label:"อำเภอ/เขต"}},[a("ValidationProvider",{attrs:{name:"Amphoe",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"amphoe",size:"default",color:"#7367f0",placeholder:"อำเภอ/เขต"},on:{select:e.select},model:{value:e.addressDetails.amphoe,callback:function(t){e.$set(e.addressDetails,"amphoe",t)},expression:"addressDetails.amphoe"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"province",label:"จังหวัด"}},[a("ValidationProvider",{attrs:{name:"Province",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"province",size:"default",color:"#7367f0",placeholder:"จังหวัด"},on:{select:e.select},model:{value:e.addressDetails.province,callback:function(t){e.$set(e.addressDetails,"province",t)},expression:"addressDetails.province"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"zipcode",label:"รหัสไปรษณีย์"}},[a("ValidationProvider",{attrs:{name:"Zipcode",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"zipcode",size:"default",color:"#7367f0",placeholder:"รหัสไปรษณีย์"},on:{select:e.select},model:{value:e.addressDetails.zipcode,callback:function(t){e.$set(e.addressDetails,"zipcode",t)},expression:"addressDetails.zipcode"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1)],1)],1)],1),a("hr"),a("b-card-text",{staticClass:"mb-3",on:{click:function(t){return e.changeAddress("new")}}},[a("b-form-radio",{class:e.firstCollapsed?"address-not-use":"address-use",attrs:{value:"new"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},[e._v(" ใช้ที่อยู่อื่น")])],1),a("validation-observer",{ref:"Rules2"},[a("b-collapse",{model:{value:e.secondCollapsed,callback:function(t){e.secondCollapsed=t},expression:"secondCollapsed"}},[a("b-row",[a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"Name",label:"ชื่อ-สกุล"}},[a("ValidationProvider",{attrs:{name:"Name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"name",placeholder:"กรอกชื่อ-สกุล",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.newform.name,callback:function(t){e.$set(e.newform,"name",t)},expression:"newform.name"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"Phone",label:"เบอร์โทรศัพท์"}},[a("ValidationProvider",{attrs:{name:"Phone",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-input-group",[a("cleave",{staticClass:"form-control",class:s.length>0?"non-valid":"valid",attrs:{id:"phone",raw:!1,options:e.optionsMark.phoneNumber,placeholder:"08x xxx xxxx"},model:{value:e.newform.phone,callback:function(t){e.$set(e.newform,"phone",t)},expression:"newform.phone"}})],1),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"3"}},[a("b-form-group",{attrs:{"label-for":"houseNumber",label:"บ้านเลขที่"}},[a("ValidationProvider",{attrs:{name:"houseNumber",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"houseNumber2",placeholder:"กรอกบ้านเลขที่",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.newform.houseNumber,callback:function(t){e.$set(e.newform,"houseNumber",t)},expression:"newform.houseNumber"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"3"}},[a("b-form-group",{attrs:{"label-for":"soy",label:"ซอย"}},[a("ValidationProvider",{attrs:{name:"Soy",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"soy2",placeholder:"กรอกซอย",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.newform.soy,callback:function(t){e.$set(e.newform,"soy",t)},expression:"newform.soy"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"road",label:"ถนน"}},[a("ValidationProvider",{attrs:{name:"Road",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"road2",placeholder:"กรอกชื่อถนน",autocomplete:"off",state:!(s.length>0)&&null},model:{value:e.newform.road,callback:function(t){e.$set(e.newform,"road",t)},expression:"newform.road"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"district",label:"ตำบล/แขวง"}},[a("ValidationProvider",{attrs:{name:"District",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"district",color:"#7367f0",size:"default",placeholder:"ตำบล/แขวง"},on:{select:e.selectNew},model:{value:e.newform.district,callback:function(t){e.$set(e.newform,"district",t)},expression:"newform.district"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"amphoe",label:"อำเภอ/เขต"}},[a("ValidationProvider",{attrs:{name:"Amphoe",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"amphoe",size:"default",color:"#7367f0",placeholder:"อำเภอ/เขต"},on:{select:e.selectNew},model:{value:e.newform.amphoe,callback:function(t){e.$set(e.newform,"amphoe",t)},expression:"newform.amphoe"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"province",label:"จังหวัด"}},[a("ValidationProvider",{attrs:{name:"Province",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"province",size:"default",color:"#7367f0",placeholder:"จังหวัด"},on:{select:e.selectNew},model:{value:e.newform.province,callback:function(t){e.$set(e.newform,"province",t)},expression:"newform.province"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"zipcode",label:"รหัสไปรษณีย์"}},[a("ValidationProvider",{attrs:{name:"Zipcode",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("ThailandAutoComplete",{class:s.length>0?"non-valid":"valid",attrs:{type:"zipcode",size:"default",color:"#7367f0",placeholder:"รหัสไปรษณีย์"},on:{select:e.selectNew},model:{value:e.newform.zipcode,callback:function(t){e.$set(e.newform,"zipcode",t)},expression:"newform.zipcode"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1)],1)],1)],1)],1),a("div",{staticClass:"text-between mb-4"},[a("b-button",{attrs:{variant:"outline-primary"},on:{click:e.prevTab}},[a("i",{staticClass:"fa fa-angle-left"}),e._v(" ย้อนกลับ")]),a("b-button",{attrs:{variant:"primary",type:"submit"}},[e._v("เลือกขนส่ง "),a("i",{staticClass:"fa fa-angle-right"})])],1)],1),a("TotalPrice")],1)],1)},x=[],k=a("ae39"),w=a("7bb1"),D=a("0a35"),$=a("2083"),P=a.n($),S=(a("b15d"),{name:"CheckoutAddress",components:{ValidationProvider:w["b"],ValidationObserver:w["a"],TotalPrice:h,SaveIcon:D["m"],Cleave:P.a},data(){return{optionsMark:{phoneNumber:{phone:!0,phoneRegionCode:"TH",delimiter:"-"}},firstCollapsed:!0,secondCollapsed:!1,selected:"old",required:k["b"],newform:{name:"",phone:"",road:"",soy:"",houseNumber:"",district:"",amphoe:"",province:"",zipcode:""}}},methods:{select(e){this.$emit("changDataAddress",e)},selectNew(e){this.newform.district=e.district,this.newform.amphoe=e.amphoe,this.newform.province=e.province,this.newform.zipcode=e.zipcode},changeAddress(e){"old"==e?(this.firstCollapsed=!0,this.secondCollapsed=!1,this.selected="old",this.$refs.Rules.reset()):(this.firstCollapsed=!1,this.secondCollapsed=!0,this.selected="new",this.$refs.Rules2.reset())},updateAddress(){this.$emit("updataAddress")},submit(){this.firstCollapsed?this.$refs.Rules.validate().then(e=>{e&&(this.$emit("addressData",""),this.$emit("next-step"),this.$emit("update-step",3))}):this.$refs.Rules2.validate().then(e=>{e&&(this.$emit("addressData",this.newform),this.$emit("update-step",3),this.$emit("next-step"))})},prevTab(){this.$emit("prev-step"),this.$emit("update-step",1)}},props:["addressDetails"]}),I=S,N=(a("b38a"),Object(v["a"])(I,_,x,!1,null,"36b8eaaa",null)),z=N.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-view product-checkout"},[a("div",{staticClass:"truck-select"},[a("b-card",{staticClass:"mb-4"},[a("div",{staticClass:"mb-2"},[e._v("ตัวเลือกการจัดส่ง")]),a("div",{staticClass:"mb-2 text-small"},[e._v("จัดส่งปกติ "),a("span",{staticClass:"text-muted text-small "},[e._v("*ส่งฟรี (เมื่อซื้อครบ 1,000 บาท)")])]),e.showError?a("div",{staticClass:"mb-3 text-center"},[a("b-alert",{attrs:{show:"",variant:"warning"}},[e._v("โปรดเลือกวิธีการจัดส่ง")])],1):e._e(),a("div",{staticClass:"all-company"},e._l(e.$store.state.optionCompany,(function(t,s){return a("div",{key:s},[a("div",{staticClass:"card-option border rounded h-100 p-3 mb-3",class:e.active==t.name?"card-active":"",on:{click:function(a){return e.selectCompany(t)}}},[a("div",{staticClass:"row align-items-center h-100"},[a("div",{staticClass:"col-auto pr-0"},[e.active==t.name?a("span",[a("b-form-radio",{attrs:{value:e.$store.state.deliverCompany.name},model:{value:e.$store.state.deliverCompany.name,callback:function(t){e.$set(e.$store.state.deliverCompany,"name",t)},expression:"$store.state.deliverCompany.name"}})],1):e._e(),e.active!=t.name?a("span",[a("b-form-radio",{attrs:{value:!e.$store.state.deliverCompany.name},model:{value:e.$store.state.deliverCompany.name,callback:function(t){e.$set(e.$store.state.deliverCompany,"name",t)},expression:"$store.state.deliverCompany.name"}})],1):e._e()]),a("div",{staticClass:"col-auto px-2"},[t.image?a("img",{staticClass:"deliver-img",attrs:{src:t.image}}):e._e()]),a("div",{staticClass:"col pl-3 overflow-hidden",class:t.price?"border-left":"freeDeliver"},[a("div",{staticClass:"txt-black-85 text-ellipsis"},[e._v(" "+e._s(t.price?t.name:"ฟรี")+" "+e._s(t.price?" (1-3 วันทำการ)":" (เมื่อซื้อครบ 1,000 บาท)")+" ")]),a("div",[e._v(e._s(t.price?t.price+" บาท":""))])])])])])})),0)]),a("div",{staticClass:"text-between mb-4"},[a("b-button",{attrs:{variant:"outline-primary"},on:{click:e.prevTab}},[a("i",{staticClass:"fa fa-angle-left"}),e._v(" ย้อนกลับ")]),a("b-button",{attrs:{variant:"primary"},on:{click:e.nextStep}},[e._v("ชำระเงิน "),a("i",{staticClass:"fa fa-angle-right"})])],1)],1),a("TotalPrice")],1)},T=[],q={name:"CheckoutTruck",components:{TotalPrice:h},props:{},created(){""!=this.$store.state.deliverCompany.name?this.active=this.$store.state.deliverCompany.name:this.active=""},computed:{count(){return this.$store.getters.getDeliverCompany}},watch:{count(e){""!=e.name?this.active=e.name:this.active=""}},data(){return{active:"",showError:!1}},methods:{selectCompany(e){this.active=e.name,this.showError=!1;var t={price:e.price,name:e.name,image:e.image};this.$store.dispatch("selectCompany",t)},nextStep(){""!=this.active?(this.$emit("next-step"),this.$emit("update-step",4)):this.showError=!0},prevTab(){this.$emit("prev-step"),this.$emit("update-step",2)}}},A=q,R=(a("0382"),Object(v["a"])(A,O,T,!1,null,"dc86956c",null)),V=R.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-view product-checkout"},[a("div",{staticClass:"payment-page"},[a("b-card",{staticClass:"mb-4"},[a("h5",{staticClass:"mt-2 mb-2 d-flex justify-content-center"},[a("div",{staticClass:"price-all"},[e._v(" จำนวนเงินที่ต้องโอน "+e._s(e.formatPrice(e.$store.state.totalPrice+e.$store.state.deliverCompany.price))+" บาท ")])]),a("validation-observer",{ref:"Rules"},[a("b-form",{staticClass:"list-view",on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[a("b-row",{},[a("b-col",{staticClass:"text-center mb-2",attrs:{md:"6"}},[a("Qrgenerate",{attrs:{id:"0802767401",amount:e.$store.state.totalPrice+e.$store.state.deliverCompany.price}})],1),a("b-col",{staticClass:"mt-3 mb-2",attrs:{md:"6"}},[a("div",{staticClass:"mb-2"},[e._v("สแกน QR code เพื่อชำระเงิน")]),a("div",{staticClass:"mb-2"},[a("span",{staticClass:"bold"},[e._v("พร้อมเพย์ : ")]),a("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.message1,expression:"message1",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"num-pay pointer"},[e._v("080-276-7401")])]),a("div",{staticClass:"separator"},[e._v("หรือ")]),a("div",{staticClass:"mt-2 mb-2"},[e._v("ธนาคาร ไทยพาณิชย์ (SCB)")]),a("div",{staticClass:"mb-2"},[a("span",{staticClass:"bold"},[e._v("ชื่อบัญชี : ")]),e._v("ณัฐพงศ์ ยูวิหค ")]),a("div",{staticClass:"mb-2"},[a("span",{staticClass:"bold"},[e._v("เลขที่บัญชี : ")]),a("span",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.message,expression:"message",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],staticClass:"num-pay pointer"},[e._v("264-281783-1")])])])],1),a("b-row",{staticClass:"mt-3"},[a("b-col",{attrs:{md:"6"}},[a("b-form-group",{staticClass:"mb-2",attrs:{label:"โอนจากธนาคาร","label-for":"bank-type"}},[a("ValidationProvider",{attrs:{name:"Bank",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-select",{attrs:{id:"bank-type",options:e.options,state:!(s.length>0)&&null},model:{value:e.form.bank,callback:function(t){e.$set(e.form,"bank",t)},expression:"form.bank"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"dateTime",label:"วัน-เวลาที่โอน"}},[a("ValidationProvider",{attrs:{name:"DateTime",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("date-picker",{class:s.length>0?"non-valid":"valid",attrs:{valueType:"format",format:"DD-MM-YYYY HH:mm",type:"datetime",placeholder:"เลือกวัน-เวลา ตามหลักฐานการชำระ"},model:{value:e.form.dateTime,callback:function(t){e.$set(e.form,"dateTime",t)},expression:"form.dateTime"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"Note",label:"หมายเหตุ"}},[a("b-form-textarea",{attrs:{id:"Note",placeholder:"รายละเอียดเพิ่มเติม"},model:{value:e.form.note,callback:function(t){e.$set(e.form,"note",t)},expression:"form.note"}})],1)],1),a("b-col",{attrs:{md:"6"}},[a("ValidationProvider",{attrs:{name:"Slip",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-group",{attrs:{"label-for":"Slip",label:"หลักฐานการชำระ (สลิป)"}},[a("b-button",{staticClass:"mb-75 mr-75",attrs:{variant:"primary",size:"sm"},on:{click:function(t){return e.$refs.refInputEl.$el.click()}}},[e._v(" อัปโหลด ")]),a("b-form-file",{ref:"refInputEl",attrs:{accept:".jpg, .png",hidden:!0,plain:"",state:!(s.length>0)&&null},on:{input:e.pickFile},model:{value:e.form.image,callback:function(t){e.$set(e.form,"image",t)},expression:"form.image"}})],1),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])}),a("div",{staticClass:"mb-3"},[""!=e.preview?a("img",{ref:"refPreviewEl",staticClass:"rounded mr-2 mb-1 mb-md-0 custom-show-img-table",attrs:{src:e.preview,height:"150",width:"150"}}):e._e()])],1)],1),a("div",{staticClass:"mt-3"},[a("b-button",{attrs:{variant:"primary",type:"submit",block:""}},[e._v("ยืนยันการชำระเงิน")])],1)],1)],1)],1),a("div",{staticClass:"text-between mb-4"},[a("b-button",{attrs:{variant:"outline-primary"},on:{click:e.prevTab}},[a("i",{staticClass:"fa fa-angle-left"}),e._v(" ย้อนกลับ")]),a("b-button",{attrs:{variant:"outline-success"},on:{click:e.saveLater}},[e._v("ยืนยันคำสั่งซื้อและชำระเงินภายหลัง")])],1)],1),a("TotalPrice")],1)},E=[],F=a("78c6"),W={name:"CheckoutPayment",components:{ValidationProvider:w["b"],ValidationObserver:w["a"],TotalPrice:h,Qrgenerate:F["a"]},data(){return{required:k["b"],preview:"",message1:"080-276-7401",message:"264-281783-1",options:[{value:"ไทยพาณิชย์",text:"ไทยพาณิชย์"},{value:"กสิกรไทย",text:"กสิกรไทย"},{value:"กรุงไทย",text:"กรุงไทย"},{value:"กรุงเทพ",text:"กรุงเทพ"},{value:"กรุงศรี",text:"กรุงศรี"},{value:"ธนชาต",text:"ธนชาต"},{value:"ทหารไทย",text:"ทหารไทย"},{value:"ออมสิน",text:"ออมสิน"},{value:"ธ.ก.ส.",text:"ธ.ก.ส."},{value:"เกียรตินาคิน",text:"เกียรตินาคิน"}],form:{info:"",note:"",bank:"",image:"",dateTime:""}}},methods:{submit(){this.$refs.Rules.validate().then(e=>{e&&this.$emit("save-confirm",this.form)})},pickFile(){let e=this.$refs.refInputEl,t=e.files;if(this.fileUpload=t[0],this.fileUpload.size<8e5&&t&&t[0]){let e=new FileReader;e.onload=e=>{this.preview=e.target.result},e.readAsDataURL(t[0]),this.form.image=t[0]}},saveLater(){this.$emit("save-later")},formatPrice(e){let t=(e/1).toFixed(0);return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},prevTab(){this.$emit("prev-step"),this.$emit("update-step",3)},onCopy:function(e){console.log(e.text),this.$toast("คัดลอกแล้ว",{position:"top-center",closeOnClick:!0,hideProgressBar:!0,timeout:1500,icon:"fas fa-copy"})}}},j=W,L=(a("bff8"),Object(v["a"])(j,B,E,!1,null,"71f93513",null)),U=L.exports,M={name:"Checkout",components:{FormWizard:i["FormWizard"],TabContent:i["TabContent"],CheckoutCart:y,CheckoutAddress:z,CheckoutDeliver:V,CheckoutPayment:U},data(){return{loading:!1,showOverlay:!1,step:1,role:"",userID:"",userData:{name:"",phone:"",road:"",soy:"",houseNumber:"",district:"",amphoe:"",province:"",zipcode:""},addressSelect:{},nextOrderID:"OR00001"}},created(){const e=o["a"].auth().currentUser;e&&e.getIdTokenResult().then(e=>{this.role=e.claims.role?e.claims.role:"user","admin"!=this.role&&this.loadUserData()})},methods:{loadUserData(){this.loading=!0;const e=o["a"].auth().currentUser,t=o["a"].firestore().doc("users/"+e.uid);return t.get().then(e=>{this.userID=e.id;var t={displayName:e.data().name,image:e.data().image,name:e.data().address.name?e.data().address.name:"",phone:e.data().address.phone?e.data().address.phone:"",district:e.data().address.district?e.data().address.district:"",amphoe:e.data().address.amphoe?e.data().address.amphoe:"",province:e.data().address.province?e.data().address.province:"",zipcode:e.data().address.zipcode?e.data().address.zipcode:"",road:e.data().address.road?e.data().address.road:"",houseNumber:e.data().address.houseNumber?e.data().address.houseNumber:"",soy:e.data().address.soy?e.data().address.soy:""};this.loading=!1,this.userData=t})},addressData(e){e?(this.addressSelect=e,this.$store.dispatch("selectAddress",this.addressSelect.province)):(this.addressSelect=this.userData,this.$store.dispatch("selectAddress",this.addressSelect.province))},updateAddress(){var e={address:{name:this.userData.name,phone:this.userData.phone,road:this.userData.road,soy:this.userData.soy,houseNumber:this.userData.houseNumber,district:this.userData.district,amphoe:this.userData.amphoe,province:this.userData.province,zipcode:this.userData.zipcode}};const t=o["a"].firestore().doc("users/"+this.userID);t.update(e).then(()=>{this.loadUserData(),this.$toast.success("อัปเดตข้อมูลเรียบร้อย",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-check-circle"})}).catch(e=>{this.$toast.error("อัปเดตข้อมูลไม่สำเร็จ",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-exclamation-triangle"}),console.log(e)})},saveDataOrder(){var e=this.$store.state.totalPrice,t=this.$store.state.deliverCompany.price,a=this.$store.state.deliverCompany.name,s=this.$store.state.cartItems,r=[];s.map(e=>{var t={quantity:e.qty,productID:e.productID,id:e.id,name:e.name,price:e.price,catagory:e.catagory,discount:e.discount,fullprice:e.fullprice,image:e.image,detail:e.detail};r.push(t)});const i=o["a"].firestore().collection("orders");i.orderBy("createAt","desc").limit(1).get().then(s=>{s.forEach(e=>{var t=e.data().orderID,a=t.substring(2,7),s=parseInt(a)+1,r=s.toString().length;1==r?this.nextOrderID="OR0000"+s:2==r?this.nextOrderID="OR000"+s:3==r?this.nextOrderID="OR00"+s:4==r&&(this.nextOrderID="OR0"+s)});var i={orderID:this.nextOrderID,userID:this.userID,items:r,slipImage:"",slipDate:"",payon:"",address:this.addressSelect,deliverPrice:t,deliverCompany:a,deliverNumber:"",createAt:new Date,updateAt:new Date,status:"รอชำระ",totalPrice:e,totalAll:e+t,note:"",formBank:""};this.addNewOrder(i)})},saveDataConfirm(e){this.showOverlay=!0;var t=this.$store.state.totalPrice,a=this.$store.state.deliverCompany.price,s=this.$store.state.deliverCompany.name,r=this.$store.state.cartItems,i=[];r.map(e=>{var t={quantity:e.qty,productID:e.productID,id:e.id,name:e.name,price:e.price,catagory:e.catagory,discount:e.discount,fullprice:e.fullprice,image:e.image,detail:e.detail};i.push(t)});const l=o["a"].firestore().collection("orders");l.orderBy("createAt","desc").limit(1).get().then(r=>{r.forEach(e=>{var t=e.data().orderID,a=t.substring(2,7),s=parseInt(a)+1,r=s.toString().length;1==r?this.nextOrderID="OR0000"+s:2==r?this.nextOrderID="OR000"+s:3==r?this.nextOrderID="OR00"+s:4==r&&(this.nextOrderID="OR0"+s)});var l={orderID:this.nextOrderID,userID:this.userID,items:i,slipImage:"",slipDate:e.dateTime,payon:new Date,address:this.addressSelect,deliverPrice:a,deliverCompany:s,deliverNumber:"",createAt:new Date,updateAt:new Date,status:"รอการตรวจสอบ",totalPrice:t,totalAll:t+a,note:e.note,formBank:e.bank},n=e.image;if(""!=n){var d=new Date;const e=d.valueOf().toString();o["a"].storage().ref("slips").child(e).put(n).then(e=>{e.ref.getDownloadURL().then(e=>{l.slipImage=e;const t=o["a"].firestore().collection("orders");return t.add(l).then(()=>{this.showOverlay=!1,this.sentMessageLineBot(l),this.$store.dispatch("clearItem",[]),this.$swal({title:"สำเร็จ!",text:"ยืนยันคำสั่งซื้อเรียบร้อย",icon:"success",confirmButtonText:"ตกลง",width:"500px",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}),this.$router.replace("/user-order")}).catch(e=>{this.showOverlay=!1,console.log(e)})}).catch(e=>{this.showOverlay=!1,console.log(e)})}).catch(e=>{this.showOverlay=!1,console.log(e)})}})},changDataAddress(e){this.userData.district=e.district,this.userData.amphoe=e.amphoe,this.userData.province=e.province,this.userData.zipcode=e.zipcode},sentMessageLineBot(e){var t={name:this.userData.displayName,image:this.userData.image,payon:e.payon,totalAll:e.totalAll,totalItem:e.items.length,orderID:e.orderID,slip:e.slipImage};const a=o["a"].firestore().collection("oders");return a.add(t).then(()=>{})},addNewOrder(e){this.showOverlay=!0;const t=o["a"].firestore().collection("orders");return t.add(e).then(()=>{this.showOverlay=!1,this.$store.dispatch("clearItem",[]),this.$swal({title:"สำเร็จ!",text:"บันทึกคำสั่งซื้อเรียบร้อย",icon:"success",confirmButtonText:"ตกลง",width:"500px",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}),this.$router.replace("/user-order")}).catch(e=>{this.showOverlay=!1,console.log(e)})},updateStep(e){this.step=e}},setup(){const e=Object(l["k"])(null),t=()=>{e.value.nextTab()},a=()=>{e.value.prevTab()};return{refFormWizard:e,formWizardNextStep:t,formWizardPrevStep:a}}},Q=M,H=(a("ec25"),Object(v["a"])(Q,s,r,!1,null,null,null));t["default"]=H.exports},cdbf:function(e,t,a){},d652:function(e,t,a){},ec25:function(e,t,a){"use strict";a("cdbf")},f963:function(e,t,a){}}]);
//# sourceMappingURL=chunk-dcb6f6fc.ada277f6.js.map