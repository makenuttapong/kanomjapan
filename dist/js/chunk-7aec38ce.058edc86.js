(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7aec38ce"],{"16e5":function(t,a,e){"use strict";e("6860")},2458:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",[s("b-card",{staticClass:"mb-4"},[s("h5",{staticClass:"mb-4"},[s("i",{staticClass:"fa fa-cookie-bite",attrs:{color:"#7367f0"}}),t._v(" รายละเอียดสินค้า ")]),t.loading?s("div",{staticClass:"p-4"},[s("b-row",{staticClass:"my-2"},[s("b-col",{staticClass:"\n            d-flex\n            align-items-center\n            justify-content-center\n            mb-4 mb-md-0\n          ",attrs:{cols:"12",md:"6"}},[s("vcl-twitch")],1),s("b-col",{attrs:{cols:"12",md:"6"}},[s("vcl-list")],1)],1)],1):t._e(),t.loading?t._e():s("div",[s("b-card-body",[s("b-row",{staticClass:"my-2"},[s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center\n              mb-4 mb-md-0\n            ",attrs:{cols:"12",md:"5"}},[s("b-row",[s("b-col",{attrs:{md:"12"}},[s("div",{staticClass:"\n                    d-flex\n                    align-items-center\n                    justify-content-center\n                    p-3\n                    itemType\n                  "},["สินค้าขายดี"==t.product.productType?s("div",{staticClass:"img-badge good-sold",class:0==t.product.stock?"out":""},[t._v(" "+t._s(t.product.productType)+" ")]):t._e(),"สินค้าแนะนำ"==t.product.productType?s("div",{staticClass:"img-badge recommend",class:0==t.product.stock?"out":""},[t._v(" "+t._s(t.product.productType)+" ")]):t._e(),s("ExpandableImage",{class:0==t.product.stock?"img-gray":"product-img",attrs:{src:t.product.image?t.product.image:e("c548"),fluid:""}})],1)]),0!=t.product.moreImage.length?s("b-col",{attrs:{md:"12"}},[s("b-row",{staticClass:"mt-4 mb-4"},t._l(t.product.moreImage,(function(a,i){return s("b-col",{key:i,attrs:{md:"4",sm:"4",cols:"4"}},[s("ExpandableImage",{staticClass:"boder-1",class:0==t.product.stock?"img-gray":"product-img",attrs:{src:a||e("c548")}})],1)})),1)],1):t._e()],1)],1),s("b-col",{attrs:{cols:"12",md:"7"}},[s("h4",[t._v(t._s(t.product.name))]),s("div",{staticClass:"ecommerce-details-price d-flex flex-wrap mt-1 mb-2"},[t.product.discount?s("div",[s("span",{staticClass:"font-dis-detail mr-3 mt-2 mb-2"},[t._v(" "+t._s(t.formatPrice(t.product.price))+" THB ")]),s("span",{staticClass:"item-price mr-3 mt-2 mb-2 fontPrice"},[t._v(" "+t._s(t.formatPrice(t.product.sale))+" THB ")])]):t._e(),t.product.discount?t._e():s("div",[s("h4",{staticClass:"item-price mr-3 mt-2 mb-2"},[t._v(" "+t._s(t.formatPrice(t.product.price))+" THB ")])])]),s("div",[s("ul",{staticClass:"unstyled-list list-inline"},[t._l(5,(function(a){return s("li",{key:a,staticClass:"ratings-list-item mr-25"},[s("i",{staticClass:"fa fa-star",class:[{"fill-current":a<=t.calStar(t.product.rating,t.product.ratingCount)},a<=t.calStar(t.product.rating,t.product.ratingCount)?"text-warning":"text-muted"]})])})),s("span",{staticClass:"pl-2 rating-text"},[t._v(" "+t._s(0!=t.product.rating?t.calStar(t.product.rating,t.product.ratingCount)+"/5":"")+" ("+t._s(t.product.ratingCount)+" รีวิว)")])],2)]),s("div",[t._v(" สินค้าคงเหลือ : "),0==t.product.stock?s("span",{staticClass:"pro-stock"},[s("b-badge",{staticClass:"status-cancle-style",attrs:{pill:""}},[t._v("สินค้าหมด")])],1):t._e(),t.product.stock<10&&0!=t.product.stock?s("span",{staticClass:"text-warning"},[t._v(" "+t._s(t.product.stock)+" ชิ้น "),s("AlertTriangleIcon",{staticClass:"ml-1 mb-1",attrs:{size:"20"}})],1):t._e(),t.product.stock>=10?s("span",{staticClass:"text-success"},[t._v(t._s(t.product.stock)+" ชิ้น")]):t._e()]),s("div",{staticClass:"mb-2"},[t._v(" ขายแล้ว : "),s("span",{staticClass:"text-mute"},[t._v(t._s(t.product.sold?t.formatPrice(t.product.sold):0))]),t._v(" ชิ้น ")]),s("span",{staticClass:"bold"},[t._v("คำอธิบายสินค้า")]),s("b-card-text",[t._v(t._s(t.product.detail?t.product.detail:"-"))]),s("hr"),s("div",{staticClass:"catagpry"},[s("span",{staticClass:"bold"},[t._v(" รหัสสินค้า : ")]),s("span",{staticClass:"pro-id"},[t._v(t._s(t.product.productID)+" ")])]),s("div",{staticClass:"catagpry"},[s("span",{staticClass:"bold"},[t._v("หมวดหมู่สินค้า : ")]),s("span",[t._v(t._s(t.product.catagory))])]),s("div",{staticClass:"catagpry"},[s("span",{staticClass:"bold"},[t._v("ยี่ห้อ : ")]),s("span",[t._v(t._s(t.product.brand?t.product.brand:"-"))])]),s("div",{staticClass:"weight"},[s("span",{staticClass:"bold"},[t._v("น้ำหนัก : ")]),s("span",[t._v(t._s(t.formatPrice(t.product.weight))+" กรัม")])]),s("div",{staticClass:"exp-date"},[s("span",{staticClass:"bold"},[t._v("วันหมดอายุ : ")]),s("span",[s("CalendarIcon",{staticClass:"mb-1 mr-1",attrs:{size:"18"}}),t._v(t._s(t.product.productEXP))],1)]),s("div",[s("span",{staticClass:"bold"},[t._v("สถานะ : ")]),t.product.show?s("span",{staticClass:"badge-5"},[s("b-badge",{staticClass:"status-check-style",attrs:{pill:""}},[t._v("แสดง")])],1):t._e(),t.product.show?t._e():s("span",{staticClass:"badge-5"},[s("b-badge",{staticClass:"status-cancle-style",attrs:{pill:""}},[t._v("ไม่แสดง")])],1)])],1)],1)],1)],1)]),s("b-card",{staticClass:"mb-4"},[s("div",{staticClass:"d-flex space-between mb-2"},[s("h5",{staticClass:"mb-3"},[s("i",{staticClass:"fas fa-chart-line",attrs:{color:"#7367f0"}}),t._v(" ยอดขายทั้งหมด ")]),s("div",{staticClass:"mx-50 select-month ml-2 mr-2"},[s("date-picker",{attrs:{valueType:"format",type:"month",format:"YYYY-MM"},on:{change:t.selectMonth},model:{value:t.monthSelect,callback:function(a){t.monthSelect=a},expression:"monthSelect"}})],1)]),t.loadingChart?s("div",{staticClass:"p-4 row"},[s("vcl-twitch",{attrs:{width:"600px"}})],1):t._e(),t.loadingChart?t._e():s("div",[s("div",{staticClass:"text-small pl-4 ml-2"},[s("b",[t._v("ทั้งหมด : ")]),t._v(t._s(t.item_chart_count)+" รายการ ")]),0!=this.lineChartSimple.series[0].data?s("vue-apex-charts",{attrs:{type:"line",height:"350",options:t.lineChartSimple.chartOptions,series:t.lineChartSimple.series}}):t._e()],1)]),s("b-card",{staticClass:"mb-4"},[s("h6",{staticClass:"mb-4"},[s("i",{staticClass:"fas fa-comment",attrs:{color:"#7367f0"}}),t._v(" คอมเมนต์ / รีวิว ("+t._s(t.itemCount)+") ")]),t.loadingComment?s("div",{staticClass:"p-4"},[s("vcl-facebook")],1):t._e(),t.loadingComment?t._e():s("div",[0==t.comments.length?s("div",[s("div",{staticClass:"text-center mt-4 mb-4"},[s("span",[t._v("ไม่พบคอมเมนต์")])])]):t._e(),0!=t.comments.length?s("div",[t._l(t.comments,(function(a,i){return s("div",{key:i,staticClass:"userList"},[s("div",{staticClass:"user-avatar"},[s("b-avatar",{attrs:{src:a.userProfile.image?a.userProfile.image:e("5651"),width:"40px"}}),s("span",{staticClass:"comm-name"},[t._v(" "+t._s(a.userProfile.name))])],1),s("div",{staticClass:"comment"},[s("div",{staticClass:"star"},[s("ul",{staticClass:"unstyled-list list-inline"},t._l(5,(function(t){return s("li",{key:t,staticClass:"ratings-list-item mr-25"},[s("i",{staticClass:"fa fa-star",class:[{"fill-current":t<=a.rating},t<=a.rating?"text-warning":"text-muted"]})])})),0)]),a.comment?s("div",{staticClass:"comm pb-3"},[t._v(" "+t._s(a.comment)+" ")]):t._e(),0!=a.moreImages.length?s("div",{staticClass:"comm-img d-flex pb-3"},t._l(a.moreImages,(function(t,a){return s("div",{key:a,staticClass:"mr-2 border"},[s("ExpandableImage",{staticClass:"md-image",attrs:{src:t}})],1)})),0):t._e(),s("div",{staticClass:"text-small text-mute"},[s("CalendarIcon",{staticClass:"mb-1 mr-1",attrs:{size:"18"}}),t._v(t._s(a.createAt)+" ")],1)]),s("hr")])})),s("b-row",[s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-start\n            ",attrs:{cols:"12",sm:"6"}},[s("span",{staticClass:"text-mute total-data"},[t._v("คอมเมนต์ที่ "+t._s(t.itemStart)+" - "+t._s(t.itemEnd)+" จาก "+t._s(t.totalDatas))])]),s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-end\n            ",attrs:{cols:"12",sm:"6"}},[s("Pagination",{attrs:{currentPage:t.currentPage+1,totalItem:t.totalDatas,itemPerPage:t.itemPerPage,start:t.itemStart,end:t.itemEnd},on:{selectedPage:t.loadMoreComment}})],1)],1)],2):t._e()])])],1)},i=[],r=e("28f7"),o=(e("78a7"),e("68ee")),c=e("c1df"),n=e.n(c),l=e("0a35"),d=e("7a4f"),m=e("1321"),u=e.n(m),p=e("6407"),h={name:"productDetail",data(){return{product:{},loading:!1,loadingChart:!1,loadingComment:!1,idProduct:this.$route.params.id,itemCount:0,item_chart_count:0,comments:[],monthSelect:"",totalDatas:null,itemPerPage:5,itemStart:null,itemEnd:null,currentPage:0,lineChartSimple:{series:[{data:[]}],chartOptions:{chart:{zoom:{enabled:!1},toolbar:{show:!1}},markers:{strokeWidth:7,strokeOpacity:1,strokeColors:["#f8f8f8"],colors:["#faa152"]},colors:["#faa152"],dataLabels:{enabled:!1},stroke:{curve:"straight"},grid:{xaxis:{lines:{show:!0}}},tooltip:{custom(t){return`<div class="px-1 py-50"><span>${t.series[t.seriesIndex][t.dataPointIndex]} รายการ</span></div>`}},xaxis:{categories:[]},yaxis:{}}}}},components:{VclTwitch:o["VclTwitch"],VclFacebook:o["VclFacebook"],VclList:o["VclList"],Pagination:p["a"],AlertTriangleIcon:l["a"],CalendarIcon:l["c"],ExpandableImage:d["a"],VueApexCharts:u.a},created(){window.scrollTo(0,0),this.loadProductDetail(),this.monthSelect=n()().startOf("months").format("YYYY-MM"),this.loadOrderMonth(this.monthSelect)},methods:{loadProductDetail(){this.loading=!0;const t=r["a"].firestore().doc("products/"+this.idProduct);return t.get().then(t=>{var a={uid:t.id,name:t.data().name,price:t.data().price,sale:t.data().sale,discount:t.data().discount,catagory:t.data().catagory,productID:t.data().productID,stock:t.data().stock,productType:t.data().productType,brand:t.data().brand,image:t.data().image,detail:t.data().detail,show:t.data().show,productEXP:t.data().productEXP,sold:t.data().sold,rating:t.data().rating,ratingCount:t.data().ratingCount,weight:t.data().weight,createAt:t.data().createAt,updateAt:t.data().updateAt,moreImage:t.data().moreImage};this.loading=!1,this.product=a,this.loadComment(a.uid)}).catch(t=>{console.log(t),this.loading=!1,this.$router.replace("/error")})},loadComment(t){this.loadingComment=!0;let a=this.itemPerPage*this.currentPage;const e=r["a"].firestore().collection("comments").where("productIdRef","==",t).orderBy("createAt","desc");return e.get().then(t=>{let s=t.docs[a];var i=t.docs.length,r=this.currentPage+1,o=r*this.itemPerPage-(this.itemPerPage-1),c=Math.min(o+this.itemPerPage-1,i);if(this.itemStart=o,this.itemEnd=c,this.totalDatas=i,s)var n=e.startAt(s).limit(this.itemPerPage);else n=e.limit(this.itemPerPage);this.itemCount=t.docs.length,n.get().then(t=>{var a=[];t.forEach(async t=>{var e={id:t.id,comment:t.data().comment,createAt:t.data().createAt?this.formatDate(t.data().createAt):"",moreImages:t.data().moreImages,orderIdRef:t.data().orderIdRef,productIdRef:t.data().productIdRef,rating:t.data().rating,userProfile:t.data().userProfile};a.push(e)}),this.comments=a,this.loadingComment=!1}).catch(t=>{console.log(t),this.loadingComment=!1})}).catch(t=>{console.log(t),this.loadingComment=!1})},loadMoreComment(t){this.currentPage=t;var a=this.product.uid;this.loadComment(a)},formatNormalDate(t){var a=t.toDate(),e=n()(a).format("DD-MM-YYYY");return e},formatDate(t){var a=t.toDate(),e=n()(a).format("DD-MM-YYYY HH:mm");return e},formatPrice(t){let a=(t/1).toFixed(0);return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},calStar(t,a){return(t/a).toFixed(1)},loadOrderMonth(t){this.loadingChart=!0;var a=r["a"].firestore().collection("orders"),e=n()().format(t+"-01 00:00"),s=n()(t).add(1,"month").format("YYYY-MM-DD 00:00"),i=[];while(e<=s)i.push(e),e=n()(e).add(1,"day").format("YYYY-MM-DD 00:00");var o=new Date(i[0]),c=new Date(i[i.length-1]);a.where("createAt",">=",o).where("createAt","<",c).get().then(a=>{var e=n()(t).endOf("month").format("DD"),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];"30"==e?s.pop():"29"==e?(s.pop(),s.pop()):"28"==e&&(s.pop(),s.pop(),s.pop()),a.forEach(t=>{var a=0;t.data().items.forEach(t=>{t.id==this.idProduct&&(a+=t.quantity)}),i.forEach((e,i)=>{this.checkDateYMD(t.data().createAt)==e&&(s[i]=s[i]+a)})});for(var r=0,o=0;o<s.length;o++)r+=s[o];this.item_chart_count=r,this.lineChartSimple.series[0].data=s,this.loadingChart=!1})},selectMonth(t){this.monthSelect=t,this.loadOrderMonth(t)},checkDateYMD(t){var a=t.toDate(),e=n()(a).format("YYYY-MM-DD 00:00");return e},checkExpDate(){},checkProductExpOut(t){var a=n()().format("DD-MM-YYYY"),e=n()(t,"DD/MM/YYYY").diff(n()(a,"DD/MM/YYYY "),"days");return e<=0},checkProductExp(t){var a=n()().format("DD-MM-YYYY"),e=n()(t,"DD/MM/YYYY").diff(n()(a,"DD/MM/YYYY "),"days");return e>0&&e<=120}}},g=h,f=(e("16e5"),e("2877")),v=Object(f["a"])(g,s,i,!1,null,"1c8928c2",null);a["default"]=v.exports},"24d9":function(t,a,e){},"30b0":function(t,a,e){"use strict";e("5a74")},5651:function(t,a,e){t.exports=e.p+"img/userDF.d961d73a.png"},"5a74":function(t,a,e){},6407:function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"overflow-auto"},[e("div",{staticClass:"pagination-item"},[e("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},on:{input:function(a){return t.updatePage(t.currentPage)}},model:{value:t.currentPage,callback:function(a){t.currentPage=a},expression:"currentPage"}})],1)])},i=[],r={name:"Pagination",props:["currentPage","totalItem","itemPerPage","start","end"],data(){return{perPage:this.itemPerPage}},methods:{updatePage(t){this.$emit("selectedPage",t-1)}},computed:{rows(){return this.totalItem}}},o=r,c=(e("30b0"),e("2877")),n=Object(c["a"])(o,s,i,!1,null,"62654af7",null);a["a"]=n.exports},6860:function(t,a,e){},"7a4f":function(t,a,e){"use strict";var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"expandable-image",class:{expanded:t.expanded},on:{click:function(a){t.expanded=!0}}},[t.expanded?e("i",{staticClass:"close-button",on:{click:function(a){t.expanded=!1}}},[e("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[e("path",{attrs:{fill:"#666666",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})])]):e("i",{staticClass:"expand-button"},[e("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[e("path",{attrs:{fill:"#000000",d:"M10,21V19H6.41L10.91,14.5L9.5,13.09L5,17.59V14H3V21H10M14.5,10.91L19,6.41V10H21V3H14V5H17.59L13.09,9.5L14.5,10.91Z"}})])]),e("img",t._b({},"img",t.$attrs,!1))])},i=[],r={inheritAttrs:!1,name:"ExpandableImage",data(){return{expanded:!1}},methods:{closeImage(t){this.expanded=!1,t.stopPropagation()},freezeVp(t){t.preventDefault()}},watch:{expanded(t){this.$nextTick(()=>{t?(this.cloned=this.$el.cloneNode(!0),this.closeButtonRef=this.cloned.querySelector(".close-button"),this.closeButtonRef.addEventListener("click",this.closeImage),document.body.appendChild(this.cloned),document.body.style.overflow="hidden",setTimeout(()=>{this.cloned.style.opacity=1},0)):(this.cloned.style.opacity=0,setTimeout(()=>{this.closeButtonRef.removeEventListener("click",this.closeImage),this.cloned.remove(),this.cloned=null,this.closeButtonRef=null,document.body.style.overflow="auto"},250))})}}},o=r,c=(e("8b40"),e("2877")),n=Object(c["a"])(o,s,i,!1,null,null,null);a["a"]=n.exports},"8b40":function(t,a,e){"use strict";e("24d9")},c548:function(t,a,e){t.exports=e.p+"img/NoImage.4963814d.png"}}]);
//# sourceMappingURL=chunk-7aec38ce.058edc86.js.map