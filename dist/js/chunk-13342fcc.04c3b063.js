(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13342fcc"],{"24d9":function(t,e,a){},"30b0":function(t,e,a){"use strict";a("5a74")},5651:function(t,e,a){t.exports=a.p+"img/userDF.d961d73a.png"},"5a74":function(t,e,a){},6407:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"overflow-auto"},[a("div",{staticClass:"pagination-item"},[a("b-pagination",{attrs:{"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table"},on:{input:function(e){return t.updatePage(t.currentPage)}},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)])},i=[],n={name:"Pagination",props:["currentPage","totalItem","itemPerPage","start","end"],data(){return{perPage:this.itemPerPage}},methods:{updatePage(t){this.$emit("selectedPage",t-1)}},computed:{rows(){return this.totalItem}}},l=n,r=(a("30b0"),a("2877")),o=Object(r["a"])(l,s,i,!1,null,"62654af7",null);e["a"]=o.exports},"70f5":function(t,e,a){},"7a4f":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"expandable-image",class:{expanded:t.expanded},on:{click:function(e){t.expanded=!0}}},[t.expanded?a("i",{staticClass:"close-button",on:{click:function(e){t.expanded=!1}}},[a("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{fill:"#666666",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})])]):a("i",{staticClass:"expand-button"},[a("svg",{staticStyle:{width:"24px",height:"24px"},attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{fill:"#000000",d:"M10,21V19H6.41L10.91,14.5L9.5,13.09L5,17.59V14H3V21H10M14.5,10.91L19,6.41V10H21V3H14V5H17.59L13.09,9.5L14.5,10.91Z"}})])]),a("img",t._b({},"img",t.$attrs,!1))])},i=[],n={inheritAttrs:!1,name:"ExpandableImage",data(){return{expanded:!1}},methods:{closeImage(t){this.expanded=!1,t.stopPropagation()},freezeVp(t){t.preventDefault()}},watch:{expanded(t){this.$nextTick(()=>{t?(this.cloned=this.$el.cloneNode(!0),this.closeButtonRef=this.cloned.querySelector(".close-button"),this.closeButtonRef.addEventListener("click",this.closeImage),document.body.appendChild(this.cloned),document.body.style.overflow="hidden",setTimeout(()=>{this.cloned.style.opacity=1},0)):(this.cloned.style.opacity=0,setTimeout(()=>{this.closeButtonRef.removeEventListener("click",this.closeImage),this.cloned.remove(),this.cloned=null,this.closeButtonRef=null,document.body.style.overflow="auto"},250))})}}},l=n,r=(a("8b40"),a("2877")),o=Object(r["a"])(l,s,i,!1,null,null,null);e["a"]=o.exports},"8b40":function(t,e,a){"use strict";a("24d9")},"8e83":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-card",{staticClass:"overflow-hidden"},[s("h5",{staticClass:"mb-4"},[s("i",{staticClass:"fas fa-comment",attrs:{color:"#7367f0"}}),t._v(" คอมเมนต์ ")]),s("div",{staticClass:"mb-3 mx-2"},[s("b-row",[s("b-col",{staticClass:"d-flex align-items-center justify-content-start mb-1",attrs:{cols:"12",lg:"3",md:"6"}},[s("label",[t._v("แสดง")]),s("b-select",{staticClass:"\n              per-page-selector\n              d-inline-block\n              mx-50\n              select-per-page\n              ml-2\n              mr-2\n            ",attrs:{options:t.perPageOptions,clearable:!1},on:{change:t.changeItemPerPage},model:{value:t.itemPerPage,callback:function(e){t.itemPerPage=e},expression:"itemPerPage"}}),s("label",[t._v("รายการ")])],1),s("b-col",{staticClass:"d-none d-md-inline",attrs:{cols:"12",lg:"3",md:"6"}},[s("div",{staticClass:"d-flex align-items-center justify-content-end mb-1"},[s("label",[t._v("คะแนน")]),s("b-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{options:t.filterStar,clearable:!1},on:{change:t.changeStar},model:{value:t.starFilter,callback:function(e){t.starFilter=e},expression:"starFilter"}})],1)]),s("b-col",{staticClass:"d-md-none",attrs:{cols:"12",lg:"6",md:"6"}},[s("div",{staticClass:"mb-3  text-right custom-filters"},[s("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"collapse-filter",expression:"'collapse-filter'"}],staticClass:"collapse-icon",attrs:{size:"sm",variant:"outline-info"}},[t._v("ฟิลเตอร์ "),s("div",{staticClass:"col-1 icon-coll d-inline"},[s("i",{staticClass:"fa fa-chevron-up icon-coll-open-filter"})])])],1),s("b-collapse",{attrs:{id:"collapse-filter"}},[s("div",{staticClass:"d-flex align-items-center justify-content-end mb-1"},[s("label",[t._v("คะแนน")]),s("b-select",{staticClass:"per-page-selector d-inline-block mx-50 ml-2 mr-2",attrs:{options:t.filterStar,clearable:!1},on:{change:t.changeStar},model:{value:t.starFilter,callback:function(e){t.starFilter=e},expression:"starFilter"}})],1)])],1)],1)],1),t.loading?s("div",{staticClass:"p-5"},[s("vcl-table")],1):t._e(),t.loading?t._e():s("div",[s("b-card-body",[0!=this.comments.length?s("div",{staticClass:"text-mute mb-2"},[t._v(" คอมเมนต์ที่ "+t._s(t.itemStart)+" - "+t._s(t.itemEnd)+" จาก "+t._s(t.totalDatas)+" ")]):t._e(),s("b-table",{attrs:{items:t.comments,fields:t.fields,hover:!0,responsive:"","show-empty":"","empty-text":"ไม่พบข้อมูล","empty-filtered-text":"ไม่พบข้อมูล","tbody-tr-class":"tableHover"},scopedSlots:t._u([{key:"cell(user)",fn:function(e){return[s("div",{staticClass:"name-width"},[s("b-avatar",{attrs:{size:"36",src:e.item.userProfile.image?e.item.userProfile.image:a("5651")}}),s("span",[t._v(" "+t._s(e.item.userProfile.name))])],1)]}},{key:"cell(star)",fn:function(e){return[s("div",{staticClass:"pro-star"},[s("ul",{staticClass:"unstyled-list list-inline"},t._l(5,(function(t){return s("li",{key:t,staticClass:"ratings-list-item mr-25"},[s("i",{staticClass:"fa fa-star",class:[{"fill-current":t<=e.item.rating},t<=e.item.rating?"text-warning":"text-muted"]})])})),0)])]}},{key:"cell(comment)",fn:function(e){return[s("div",{staticClass:"comment-width"},[s("span",{staticClass:"link-detail",on:{click:function(a){return t.productRef(e.item.productIdRef)}}},[t._v(t._s(e.item.comment?e.item.comment:"-"))])])]}},{key:"cell(image)",fn:function(e){return[s("div",{staticClass:"rating-width"},[0!=e.item.moreImages.length?s("div",{staticClass:"comm-img d-flex"},t._l(e.item.moreImages,(function(t,e){return s("div",{key:e,staticClass:"mr-2 border"},[s("ExpandableImage",{staticClass:"xs-image",attrs:{src:t}})],1)})),0):t._e()])]}},{key:"cell(createAt)",fn:function(e){return[s("div",{staticClass:"time-width text-small"},[t._v(t._s(e.item.createAt))])]}}],null,!1,2778190089)})],1),0!=this.comments.length?s("div",{staticClass:"mx-2"},[s("b-row",[s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-start\n            ",attrs:{cols:"12",sm:"6"}},[s("span",{staticClass:"text-mute total-data"},[t._v("คอมเมนต์ที่ "+t._s(t.itemStart)+" - "+t._s(t.itemEnd)+" จาก "+t._s(t.totalDatas))])]),s("b-col",{staticClass:"\n              d-flex\n              align-items-center\n              justify-content-center justify-content-sm-end\n            ",attrs:{cols:"12",sm:"6"}},[s("Pagination",{attrs:{currentPage:this.$store.state.currentP+1,totalItem:t.totalDatas,itemPerPage:t.itemPerPage,start:t.itemStart,end:t.itemEnd},on:{selectedPage:t.loadMore}})],1)],1)],1):t._e()],1)])],1)},i=[],n=a("28f7"),l=a("68ee"),r=a("c1df"),o=a.n(r),c=a("6407"),m=a("7a4f"),d={name:"Comments",data(){return{loading:!1,starFilter:"ทั้งหมด",filterStar:["ทั้งหมด","5 ดาว","4 ดาว","3 ดาว","2 ดาว","1 ดาว"],fields:[{key:"user",sortable:!0},{key:"star"},{key:"comment",sortable:!0},{key:"image",sortable:!0},{key:"createAt",sortable:!0}],comments:[],perPageOptions:["25","50","75"],totalDatas:null,itemPerPage:25,itemStart:null,itemEnd:null}},components:{VclTable:l["VclTable"],Pagination:c["a"],ExpandableImage:m["a"]},created(){this.loadComments()},methods:{loadComments(){this.loading=!0;let t=this.itemPerPage*this.$store.state.currentP;const e=n["a"].firestore().collection("comments");var a,s;"ทั้งหมด"!=this.starFilter?("5 ดาว"==this.starFilter?s=5:"4 ดาว"==this.starFilter?s=4:"3 ดาว"==this.starFilter?s=3:"2 ดาว"==this.starFilter?s=2:"1 ดาว"==this.starFilter&&(s=1),a=e.where("rating","==",s)):a=e.orderBy("createAt","desc");return a.get().then(e=>{let s=e.docs[t];var i=e.docs.length,n=this.$store.state.currentP+1,l=n*this.itemPerPage-(this.itemPerPage-1),r=Math.min(l+this.itemPerPage-1,i);if(this.itemStart=l,this.itemEnd=r,this.totalDatas=i,s)var o=a.startAt(s).limit(this.itemPerPage);else o=a.limit(this.itemPerPage);return o.get().then(t=>{var e=[];t.forEach(t=>{const a={id:t.id,comment:t.data().comment,createAt:t.data().createAt?this.formatDate(t.data().createAt):"",moreImages:t.data().moreImages,orderIdRef:t.data().orderIdRef,productIdRef:t.data().productIdRef,rating:t.data().rating,userProfile:t.data().userProfile};e.push(a)}),this.comments=e,this.loading=!1}).catch(t=>{this.loading=!1,console.log(t)})}).catch(t=>{this.loading=!1,console.log(t)})},formatDate(t){var e=t.toDate(),a=o()(e).format("DD-MM-YYYY HH:mm");return a},changeStar(t){this.starFilter=t,this.loadComments()},loadMore(t){this.$store.dispatch("changePage",t),this.loadComments()},changeItemPerPage(t){this.itemPerPage=t,this.loadComments()},productRef(t){this.$router.push("/admin/product/"+t)}}},u=d,g=(a("df27"),a("2877")),f=Object(g["a"])(u,s,i,!1,null,null,null);e["default"]=f.exports},df27:function(t,e,a){"use strict";a("70f5")}}]);
//# sourceMappingURL=chunk-13342fcc.04c3b063.js.map