(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4808e90e"],{"3df7":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",[a("div",{staticClass:"d-flex align-items-center mb-2"},[a("h4",{staticClass:"mb-4 ml-75"},[a("i",{staticClass:"fa fa-lock",attrs:{size:"18",color:"#7367f0"}}),e._v(" เปลี่ยนรหัสผ่าน ")])]),a("validation-observer",{ref:"Rules"},[a("b-form",{on:{submit:function(t){return t.preventDefault(),e.confirmPass(t)}}},[a("b-row",[a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{label:"รหัสผ่านเดิม","label-for":"account-old-password"}},[a("ValidationProvider",{attrs:{name:"Oldpassword",vid:"Oldpassword",rules:"required|min:8"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"account-old-password",name:"old-password",type:"password",state:!(s.length>0)&&null,placeholder:"กรอกรหัสผ่านเดิม"},model:{value:e.oldpass,callback:function(t){e.oldpass=t},expression:"oldpass"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1)],1),a("b-row",[a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"account-new-password",label:"รหัสผ่านใหม่"}},[a("ValidationProvider",{attrs:{name:"Password",vid:"Password",rules:"required|min:8"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"account-new-password",type:"password",state:!(s.length>0)&&null,name:"new-password",placeholder:"กรอกรหัสผ่านใหม่"},model:{value:e.newpass,callback:function(t){e.newpass=t},expression:"newpass"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{md:"6"}},[a("b-form-group",{attrs:{"label-for":"account-retype-new-password",label:"ยืนยันรหัสผ่านใหม่"}},[a("ValidationProvider",{attrs:{name:"Confirm Password",rules:"required|confirmed:Password"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("b-form-input",{attrs:{id:"account-retype-new-password",type:"password",name:"retype-password",state:!(s.length>0)&&null,placeholder:"กรอกรหัสผ่านใหม่อีกครั้ง"},model:{value:e.newrepass,callback:function(t){e.newrepass=t},expression:"newrepass"}}),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}])})],1)],1),a("b-col",{attrs:{cols:"12"}},[a("b-button",{staticClass:"mt-1 mr-1",attrs:{type:"submit",variant:"primary"}},[e._v(" บันทึก ")]),a("b-button",{staticClass:"mt-1",attrs:{variant:"outline-primary"},on:{click:e.resetPassInput}},[e._v(" รีเซต ")])],1)],1)],1)],1)],1)},r=[],o=a("7bb1"),i=a("ae39"),n=a("28f7"),l={name:"changePassword",data(){return{oldpass:"",newpass:"",newrepass:"",required:i["b"]}},components:{ValidationProvider:o["b"],ValidationObserver:o["a"]},methods:{confirmPass(){this.$refs.Rules.validate().then(e=>{if(e){var t=n["a"].auth().currentUser;n["a"].auth().signInWithEmailAndPassword(t.email,this.oldpass).then(()=>{t.updatePassword(this.newpass).then(()=>{this.success(),this.resetPassInput()}).catch(e=>{this.error(),console.log(e)})}).catch(e=>{this.error(),console.log(e)})}})},resetPassInput(){this.oldpass="",this.newpass="",this.newrepass="",this.$refs.Rules.reset()},signOut(){this.$store.dispatch("changePage",0),n["a"].auth().signOut().then(()=>{this.$router.replace("/"),this.$store.commit("setUser",{}),window.localStorage.setItem("userData",{}),localStorage.setItem("userProfileImage","")}).catch(e=>{console.log(e)})},success(){this.$swal({title:"สำเร็จ!",text:"เปลี่ยนรหัสผ่านสำเร็จ",icon:"success",confirmButtonText:"ตกลง",width:"500px",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1}).then(()=>{this.signOut()})},error(){this.$swal({title:"ผิดพลาด!",text:"รหัสผ่านไม่ถูกต้อง",icon:"error",confirmButtonText:"ตกลง",width:"500px",customClass:{confirmButton:"btn btn-primary"},buttonsStyling:!1})}}},d=l,c=a("2877"),m=Object(c["a"])(d,s,r,!1,null,null,null);t["a"]=m.exports},5651:function(e,t,a){e.exports=a.p+"img/userDF.d961d73a.png"},"73a6":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("b-tabs",{attrs:{vertical:"","content-class":"col-12 col-md-9 mt-1 mt-md-0",pills:"","nav-wrapper-class":"col-md-3 col-12","nav-class":"nav-left"}},[a("b-tab",{attrs:{active:""},scopedSlots:e._u([{key:"title",fn:function(){return[a("i",{staticClass:"fa fa-user mr-2",attrs:{size:"18"}}),a("span",{staticClass:"f-500"},[e._v("ข้อมูลทั่วไป")])]},proxy:!0}])},[a("General",{attrs:{data:e.adminProfile,loading:e.loading},on:{newData:e.saveNewDataGeneral}})],1),a("b-tab",{scopedSlots:e._u([{key:"title",fn:function(){return[a("i",{staticClass:"fa fa-lock mr-2",attrs:{size:"18"}}),a("span",{staticClass:"f-500"},[e._v("เปลี่ยนรหัสผ่าน")])]},proxy:!0}])},[a("ChangePassword")],1)],1)],1)},r=[],o=a("28f7"),i=a("88c2"),n=a("3df7"),l=(a("78a7"),a("c1df")),d=a.n(l),c=a("9ded"),m=a.n(c),u={name:"AdminProfile",components:{General:i["a"],ChangePassword:n["a"]},data(){return{loading:!1,adminProfile:{email:"",name:"",phone:"",gender:"",birthdate:"",lineID:""}}},created(){this.loadProfile()},methods:{loadProfile(){this.loading=!0;const e=o["a"].auth().currentUser,t=o["a"].firestore().doc("users/"+e.uid);return t.get().then(e=>{var t={uid:e.id,email:e.data().email,name:e.data().name,phone:e.data().phone?e.data().phone:"",gender:e.data().gender?e.data().gender:"",image:e.data().image?e.data().image:"",lineID:e.data().lineID,birthdate:e.data().birthdate?this.formatDate(e.data().birthdate):""};this.loading=!1,this.adminProfile=t})},formatDate(e){var t=e.toDate(),a=d()(t).format("DD-MM-YYYY");return a},saveNewDataGeneral(e){this.loading=!0;var t={image:e.image,name:e.name,phone:e.phone,gender:e.gender,birthdate:"",lineID:e.lineID};if(e.date){var a=d()(e.date,"DD/MM/YYYY"),s=d()(a).format("MM/DD/YYYY"),r=new Date(Date.parse(s));t.birthdate=r}this.updateProfile(t)},updateProfile(e){localStorage.setItem("userProfileImage",e.image);const t=o["a"].firestore().doc("users/"+this.adminProfile.uid);t.update(e).then(()=>{this.loading=!1,this.$toast.success("แก้ไขข้อมูลเรียบร้อย",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-check-circle"});var e=document.querySelector("#fullSidebar >span > img");e.src=localStorage.getItem("userProfileImage")?localStorage.getItem("userProfileImage"):m.a,this.loadProfile()}).catch(e=>{this.loading=!1,this.$toast.error("แก้ไขข้อมูลไม่สำเร็จ",{position:"top-right",closeOnClick:!0,hideProgressBar:!0,timeout:3e3,icon:"fa fa-exclamation-triangle"}),console.log(e)})}}},p=u,f=a("2877"),b=Object(f["a"])(p,s,r,!1,null,null,null);t["default"]=b.exports},"7c99":function(e,t,a){"use strict";a("8cbd")},"88c2":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",[e.loading?a("div",{staticClass:"p-2"},[a("vcl-facebook")],1):e._e(),e.loading?e._e():a("div",[a("div",{staticClass:"d-flex align-items-center mb-2"},[a("h4",{staticClass:"mb-4 ml-75"},[a("i",{staticClass:"fa fa-user",attrs:{size:"18",color:"#7367f0"}}),e._v(" ข้อมูลส่วนตัว ")])]),a("validation-observer",{ref:"Rules"},[a("b-form",{staticClass:"mt-2"},[a("b-row",[a("b-col",{attrs:{sm:"12"}},[a("b-form-group",{attrs:{label:"รูป"}},[a("b-media",{staticClass:"editImage",attrs:{"no-body":""}},[a("b-media-aside",["edit"==e.mode?a("b-avatar",{ref:"previewEl",staticClass:"img-avatar edit",attrs:{src:e.preview?e.preview:e.imageDF}}):e._e(),"show"==e.mode?a("b-avatar",{staticClass:"img-avatar edit",attrs:{src:e.data.image?e.data.image:e.imageDF}}):e._e()],1),"edit"==e.mode?a("b-media-body",{staticClass:"mt-75 ml-75 imageUp"},[a("b-button",{staticClass:"mb-75 mr-75",attrs:{variant:"primary",size:"sm"},on:{click:function(t){return e.$refs.refInputEl.$el.click()}}},[e._v(" อัปโหลด ")]),a("b-form-file",{ref:"refInputEl",attrs:{accept:".jpg, .png, .gif",hidden:!0,plain:""},on:{input:e.pickFile}}),a("b-card-text",{staticClass:"font14 mt-1"},[e._v("รูปภาพขนาดไม่เกิน 0.8 mb")])],1):e._e()],1)],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"ชื่อ","label-for":"account-name"}},[a("ValidationProvider",{attrs:{name:"Name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return["edit"==e.mode?a("b-form-input",{attrs:{state:!(s.length>0)&&null,placeholder:"กรอกชื่อ",name:"name",autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}):e._e(),a("small",{staticClass:"text-danger"},[e._v(e._s(s[0]))])]}}],null,!1,945424339)}),"show"==e.mode?a("b-form-input",{attrs:{disabled:""},model:{value:e.data.name,callback:function(t){e.$set(e.data,"name",t)},expression:"data.name"}}):e._e()],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"อีเมล","label-for":"account-e-mail"}},[a("b-form-input",{attrs:{disabled:""},model:{value:e.data.email,callback:function(t){e.$set(e.data,"email",t)},expression:"data.email"}})],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"เพศ","label-for":"account-gender"}},["edit"==e.mode?a("b-form-select",{attrs:{name:"gender",options:e.options,placeholder:"เลือกเพศ",autocomplete:"off"},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}}):e._e(),"show"==e.mode?a("b-form-input",{attrs:{disabled:""},model:{value:e.data.gender,callback:function(t){e.$set(e.data,"gender",t)},expression:"data.gender"}}):e._e()],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"วันเกิด","label-for":"account-birthdate"}},["edit"==e.mode?a("date-picker",{attrs:{valueType:"format",format:"DD-MM-YYYY"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}}):e._e(),"show"==e.mode?a("b-form-input",{attrs:{disabled:""},model:{value:e.data.birthdate,callback:function(t){e.$set(e.data,"birthdate",t)},expression:"data.birthdate"}}):e._e()],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"เบอร์โทรศัพท์","label-for":"account-phone"}},["edit"==e.mode?a("b-input-group",[a("cleave",{staticClass:"form-control",attrs:{id:"phone",raw:!1,options:e.optionsMark.phoneNumber,placeholder:"08x xxx xxxx"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1):e._e(),"show"==e.mode?a("b-form-input",{attrs:{disabled:""},model:{value:e.data.phone,callback:function(t){e.$set(e.data,"phone",t)},expression:"data.phone"}}):e._e()],1)],1),a("b-col",{attrs:{sm:"6"}},[a("b-form-group",{attrs:{label:"Line ID","label-for":"line-id"}},["edit"==e.mode?a("b-form-input",{attrs:{name:"LineID",placeholder:"กรอก Line ID",autocomplete:"off"},model:{value:e.form.lineID,callback:function(t){e.$set(e.form,"lineID",t)},expression:"form.lineID"}}):e._e(),"show"==e.mode?a("b-form-input",{attrs:{disabled:""},model:{value:e.data.lineID,callback:function(t){e.$set(e.data,"lineID",t)},expression:"data.lineID"}}):e._e()],1)],1),a("b-col",{attrs:{cols:"12"}},["show"==e.mode?a("b-button",{staticClass:"mt-2 mr-1",attrs:{variant:"primary"},on:{click:e.changeMode}},[e._v(" แก้ไข ")]):e._e(),"edit"==e.mode?a("b-button",{staticClass:"mt-2 mr-1",attrs:{variant:"primary"},on:{click:e.saveData}},[e._v(" ยืนยัน ")]):e._e(),"edit"==e.mode?a("b-button",{staticClass:"mt-2 mr-1",attrs:{variant:"outline-primary"},on:{click:e.changeMode}},[e._v(" ยกเลิก ")]):e._e()],1)],1)],1)],1)],1)])},r=[],o=a("7bb1"),i=a("ae39"),n=a("68ee"),l=a("5651"),d=a.n(l),c=a("2083"),m=a.n(c),u=(a("b15d"),{name:"general",props:["data","loading"],components:{ValidationProvider:o["b"],ValidationObserver:o["a"],VclFacebook:n["VclFacebook"],Cleave:m.a},data(){return{imageDF:d.a,mode:"show",required:i["b"],preview:"",optionsMark:{phoneNumber:{phone:!0,phoneRegionCode:"TH",delimiter:"-"}},options:[{value:"ชาย",text:"ชาย"},{value:"หญิง",text:"หญิง"}],form:{name:"",phone:null,date:"",gender:"",image:""}}},methods:{changeMode(){this.form={name:this.data.name,phone:this.data.phone,gender:this.data.gender,date:this.data.birthdate,image:this.data.image,lineID:this.data.lineID},this.preview=this.data.image,this.$refs.Rules.reset(),this.mode="show"==this.mode?"edit":"show"},saveData(){this.$refs.Rules.validate().then(e=>{e&&(this.$emit("newData",this.form),this.changeMode())})},pickFile(){let e=this.$refs.refInputEl,t=e.files;if(this.fileUpload=t[0],this.fileUpload.size<8e5&&t&&t[0]){let e=new FileReader;e.onload=e=>{this.preview=e.target.result,this.form.image=e.target.result},e.readAsDataURL(t[0])}}}}),p=u,f=(a("7c99"),a("2877")),b=Object(f["a"])(p,s,r,!1,null,null,null);t["a"]=b.exports},"8cbd":function(e,t,a){},"9ded":function(e,t,a){e.exports=a.p+"img/bot.ad88bb4c.png"}}]);
//# sourceMappingURL=chunk-4808e90e.94d411df.js.map