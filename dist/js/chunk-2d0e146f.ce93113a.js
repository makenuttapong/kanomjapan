(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e146f"],{"7a6e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-card",[a("div",{staticClass:"d-flex space-between mb-2"},[a("h5",{staticClass:"mb-3"},[a("i",{staticClass:"fas fa-inbox",attrs:{color:"#7367f0"}}),e._v(" ออเดอร์ที่ได้รับ "+e._s("month"==e.mode?"(เดือน":"(ปี")+"นี้) ")]),a("div",[a("b-dropdown",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(113, 102, 240, 0.15)",expression:"'rgba(113, 102, 240, 0.15)'",modifiers:{400:!0}}],staticClass:"margin20",attrs:{text:e.sortBy.text,right:"",variant:"outline-primary"}},e._l(e.sortByOptions,(function(t){return a("b-dropdown-item",{key:t.value,on:{click:function(a){return e.changeType(t)}}},[e._v(" "+e._s(t.text)+" ")])})),1),a("div",{staticClass:"mx-50 select-month ml-2 mr-2 d-inline-block"},["รายเดือน"==e.sortBy.text?a("date-picker",{attrs:{valueType:"format",type:"month",format:"YYYY-MM"},on:{change:e.selectMonth},model:{value:e.monthSelect,callback:function(t){e.monthSelect=t},expression:"monthSelect"}}):e._e(),"รายปี"==e.sortBy.text?a("date-picker",{attrs:{valueType:"format",type:"year",format:"YYYY"},on:{change:e.selectYear},model:{value:e.yearSelect,callback:function(t){e.yearSelect=t},expression:"yearSelect"}}):e._e()],1)],1)]),e.loading?a("div",{staticClass:"p-4 row"},[a("vcl-twitch",{attrs:{width:"600px"}})],1):e._e(),e.loading?e._e():a("div",[a("div",{staticClass:"text-small pl-4 ml-2"},[a("b",[e._v("ทั้งหมด : ")]),e._v(e._s(e.itemcount)+" รายการ ")]),0!=this.lineChartSimple.series[0].data?a("vue-apex-charts",{attrs:{type:"line",height:"400",options:e.lineChartSimple.chartOptions,series:e.lineChartSimple.series}}):e._e()],1)])},s=[],o=a("1321"),i=a.n(o),l=a("28f7"),n=a("c1df"),c=a.n(n),h=(a("78a7"),a("68ee")),d=a("e009"),m={name:"LastOrder",components:{VueApexCharts:i.a,VclTwitch:h["VclTwitch"]},directives:{Ripple:d["a"]},data(){return{loading:!1,itemcount:0,monthSelect:"",yearSelect:"",mode:"month",sortBy:{text:"รายเดือน",value:"รายเดือน"},sortByOptions:[{text:"รายเดือน",value:"รายเดือน"},{text:"รายปี",value:"รายปี"}],lineChartSimple:{series:[{data:[]}],chartOptions:{chart:{zoom:{enabled:!1},toolbar:{show:!1}},markers:{strokeWidth:7,strokeOpacity:1,strokeColors:["#f8f8f8"],colors:["#faa152"]},colors:["#faa152"],dataLabels:{enabled:!1},stroke:{curve:"straight"},grid:{xaxis:{lines:{show:!0}}},tooltip:{custom(e){return`<div class="px-1 py-50"><span>${e.series[e.seriesIndex][e.dataPointIndex]} รายการ</span></div>`}},xaxis:{categories:[]},yaxis:{}}}}},created(){this.monthSelect=c()().startOf("months").format("YYYY-MM"),this.loadOrderMonth(this.monthSelect)},methods:{selectMonth(e){this.monthSelect=e,this.loadOrderMonth(e)},loadOrderMonth(e){this.loading=!0,this.mode="month";var t=l["a"].firestore().collection("orders"),a=c()().format(e+"-01 00:00"),r=c()(e).add(1,"month").format("YYYY-MM-DD 00:00"),s=[];while(a<=r)s.push(a),a=c()(a).add(1,"day").format("YYYY-MM-DD 00:00");var o=new Date(s[0]),i=new Date(s[s.length-1]);t.where("createAt",">=",o).where("createAt","<",i).get().then(t=>{this.itemcount=t.size;var a=c()(e).endOf("month").format("DD"),r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];"30"==a?r.pop():"29"==a?(r.pop(),r.pop()):"28"==a&&(r.pop(),r.pop(),r.pop()),t.forEach(e=>{s.forEach((t,a)=>{this.checkDateYMD(e.data().createAt)==t&&(r[a]=r[a]+1)})}),this.lineChartSimple.series[0].data=r,this.lineChartSimple.chartOptions.xaxis.categories=[],this.loading=!1})},checkDateYMD(e){var t=e.toDate(),a=c()(t).format("YYYY-MM-DD 00:00");return a},changeType(e){this.sortBy=e,"รายเดือน"==e.value?(this.monthSelect=c()().startOf("months").format("YYYY-MM"),this.loadOrderMonth(this.monthSelect)):(this.yearSelect=c()().startOf("months").format("YYYY"),this.loadAllYear(this.yearSelect))},selectYear(e){this.yearSelect=e,this.loadAllYear(e)},loadAllYear(e){console.log(e),this.loading=!0,this.mode="year";var t=l["a"].firestore().collection("orders"),a=c()().format(e+"-01 00:00"),r=c()(e).add(1,"year").format("YYYY-MM 00:00"),s=[];while(a<=r)s.push(a),a=c()(a).add(1,"month").format("YYYY-MM 00:00");var o=new Date(s[0]),i=new Date(s[s.length-1]);t.where("createAt",">=",o).where("createAt","<",i).get().then(e=>{this.itemcount=e.size;var t=[0,0,0,0,0,0,0,0,0,0,0,0];e.forEach(e=>{s.forEach((a,r)=>{this.checkDateYM(e.data().createAt)==a&&(t[r]=t[r]+1)})}),this.lineChartSimple.series[0].data=t,this.lineChartSimple.chartOptions.xaxis.categories=["Jan","Feb","Mar","Apr","May","June","July","Aug","Sept","Oct","Nov","Dec"],this.loading=!1})},checkDateYM(e){var t=e.toDate(),a=c()(t).format("YYYY-MM 00:00");return a}}},p=m,Y=a("2877"),f=Object(Y["a"])(p,r,s,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-2d0e146f.ce93113a.js.map